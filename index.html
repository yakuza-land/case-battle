// maked by claude opus 4 pro
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚öîÔ∏è Case Battle Arena - Ultimate Edition</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --neon-blue: #00f0ff;
            --neon-pink: #ff00ff;
            --neon-green: #00ff88;
            --neon-orange: #ff8800;
            --neon-red: #ff3366;
            --neon-gold: #ffd700;
            --neon-purple: #9933ff;
            --bg-primary: #0a0a1a;
            --bg-secondary: #1a0a2e;
            --bg-tertiary: #0a1a2e;
            --roulette-speed: 5s;
        }

        body {
            font-family: 'Rajdhani', sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-tertiary) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: white;
        }

        body.logged-in { padding-top: 70px; }

        .font-orbitron { font-family: 'Orbitron', sans-serif; }

        /* AUTH SCREEN */
        .auth-screen {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a0a2e 50%, #0a1a2e 100%);
            z-index: 9999; display: flex; align-items: center; justify-content: center;
            flex-direction: column; padding: 20px;
        }
        .auth-screen.hidden { display: none; }

        .auth-container {
            background: linear-gradient(180deg, rgba(20,30,50,0.95) 0%, rgba(10,20,40,0.98) 100%);
            border: 2px solid rgba(0, 240, 255, 0.3); border-radius: 24px;
            padding: 40px; max-width: 450px; width: 100%;
            box-shadow: 0 0 60px rgba(0, 240, 255, 0.2);
        }

        .auth-logo {
            font-family: 'Orbitron', sans-serif; font-size: 2.5rem; font-weight: 900;
            text-align: center; margin-bottom: 10px;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-pink), var(--neon-purple));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }

        .auth-tabs { display: flex; gap: 10px; margin-bottom: 30px; }
        .auth-tab {
            flex: 1; padding: 12px; text-align: center; border-radius: 12px;
            background: rgba(255,255,255,0.05); border: 2px solid transparent;
            cursor: pointer; font-weight: bold; transition: all 0.3s;
        }
        .auth-tab.active {
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border-color: white;
        }
        .auth-tab:hover:not(.active) { background: rgba(255,255,255,0.1); }

        .auth-input {
            width: 100%; padding: 14px 18px; margin-bottom: 16px;
            background: rgba(0,0,0,0.5); border: 2px solid rgba(255,255,255,0.1);
            border-radius: 12px; color: white; font-size: 16px; transition: all 0.3s;
        }
        .auth-input:focus { outline: none; border-color: var(--neon-blue); box-shadow: 0 0 20px rgba(0, 240, 255, 0.3); }
        .auth-input::placeholder { color: #666; }

        .auth-btn {
            width: 100%; padding: 16px; border: none; border-radius: 12px;
            font-size: 18px; font-weight: bold; cursor: pointer;
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            color: white; transition: all 0.3s; margin-top: 10px;
        }
        .auth-btn:hover { transform: scale(1.02); box-shadow: 0 0 30px rgba(255, 0, 255, 0.5); }

        .auth-error { color: #ff4444; text-align: center; margin-top: 10px; font-size: 14px; min-height: 20px; }
        .auth-success { color: #44ff44; text-align: center; margin-top: 10px; font-size: 14px; }

        .auth-features {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px;
            margin-top: 40px; max-width: 600px;
        }
        .auth-feature { text-align: center; }
        .auth-feature-icon { font-size: 2rem; margin-bottom: 8px; }
        .auth-feature-text { font-size: 12px; color: #888; }

        /* TOP HEADER */
        .top-header {
            position: fixed; top: 0; left: 0; right: 0; height: 70px;
            background: linear-gradient(180deg, rgba(10,10,26,0.98) 0%, rgba(20,10,30,0.95) 100%);
            border-bottom: 2px solid rgba(0, 240, 255, 0.3);
            box-shadow: 0 4px 30px rgba(0, 240, 255, 0.2);
            z-index: 1000; display: flex; align-items: center; justify-content: space-between;
            padding: 0 20px; backdrop-filter: blur(20px);
        }
        .top-header.hidden { display: none; }

        .header-left { display: flex; align-items: center; gap: 16px; }
        .header-logo {
            font-family: 'Orbitron', sans-serif; font-size: 1.5rem; font-weight: 900;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-pink), var(--neon-purple));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
        }

        .user-profile {
            display: flex; align-items: center; gap: 10px; padding: 6px 12px;
            background: rgba(0,0,0,0.3); border-radius: 12px; cursor: pointer;
            border: 1px solid rgba(255,255,255,0.1); transition: all 0.3s;
        }
        .user-profile:hover { border-color: var(--neon-blue); }
        .user-avatar {
            width: 36px; height: 36px; border-radius: 50%;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            display: flex; align-items: center; justify-content: center; font-size: 18px;
        }
        .user-info { display: flex; flex-direction: column; }
        .user-name { font-weight: bold; font-size: 14px; }
        .user-level { font-size: 11px; color: #888; }
        
        .xp-bar-container {
            width: 100%; height: 4px; background: rgba(255,255,255,0.1);
            border-radius: 2px; margin-top: 2px; overflow: hidden;
        }
        .xp-bar {
            height: 100%; background: linear-gradient(90deg, var(--neon-green), var(--neon-blue));
            border-radius: 2px; transition: width 0.5s ease-out;
        }

        .header-center { display: flex; align-items: center; gap: 20px; }
        .header-stat {
            display: flex; flex-direction: column; align-items: center;
            padding: 8px 16px; background: rgba(0,0,0,0.3); border-radius: 12px;
        }
        .header-stat-label { font-size: 10px; text-transform: uppercase; color: #9ca3af; }
        .header-stat-value { font-family: 'Orbitron', sans-serif; font-size: 1.1rem; font-weight: bold; }

        .header-right { display: flex; align-items: center; gap: 10px; }
        .header-btn {
            display: flex; align-items: center; gap: 6px; padding: 8px 16px; border-radius: 10px;
            font-weight: bold; font-size: 13px; cursor: pointer; transition: all 0.3s; border: none;
            position: relative;
        }
        .header-btn:hover { transform: translateY(-2px); }

        .btn-settings { background: linear-gradient(135deg, #6366f1, #8b5cf6); color: white; }
        .btn-inventory { background: linear-gradient(135deg, #06b6d4, #0891b2); color: white; }
        .btn-friends { background: linear-gradient(135deg, #ec4899, #be185d); color: white; }
        .btn-admin { background: linear-gradient(135deg, #ffd700, #ff8800); color: #000; display: none; }
        .btn-admin.visible { display: flex; }
        .btn-logout { background: linear-gradient(135deg, #ef4444, #dc2626); color: white; }

        .header-badge {
            position: absolute; top: -5px; right: -5px;
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white; font-size: 10px; font-weight: bold; padding: 2px 6px;
            border-radius: 10px; min-width: 18px; text-align: center;
        }

        .online-counter {
            display: flex; align-items: center; gap: 6px; padding: 6px 12px;
            background: rgba(34, 197, 94, 0.2); border: 1px solid rgba(34, 197, 94, 0.5);
            border-radius: 20px; font-size: 12px;
        }
        .online-dot { width: 8px; height: 8px; background: #22c55e; border-radius: 50%; animation: pulse-dot 2s infinite; }
        @keyframes pulse-dot { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        /* BG Grid */
        .bg-grid {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: linear-gradient(rgba(0,240,255,0.03) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(0,240,255,0.03) 1px, transparent 1px);
            background-size: 50px 50px; pointer-events: none; z-index: 0;
        }

        /* Tabs */
        .main-tab {
            padding: 12px 24px; border-radius: 12px; font-weight: bold; font-size: 14px;
            transition: all 0.3s; cursor: pointer; border: 2px solid transparent;
            background: rgba(255,255,255,0.05);
        }
        .main-tab:hover { background: rgba(255,255,255,0.1); transform: translateY(-2px); }
        .main-tab.active {
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            border-color: white; box-shadow: 0 0 30px rgba(0, 240, 255, 0.5);
        }

        .category-tab {
            padding: 8px 16px; border-radius: 20px; font-weight: bold; font-size: 13px;
            transition: all 0.3s; cursor: pointer; border: 1px solid rgba(255,255,255,0.2);
            background: rgba(255,255,255,0.05); white-space: nowrap;
        }
        .category-tab:hover { background: rgba(255,255,255,0.15); }
        .category-tab.active {
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            border-color: white;
        }

        /* Rarity Colors */
        .rarity-trash { background: linear-gradient(135deg, #374151, #1f2937); border-color: #6b7280; }
        .rarity-common { background: linear-gradient(135deg, #6b7280, #4b5563); border-color: #9ca3af; }
        .rarity-uncommon { background: linear-gradient(135deg, #3b82f6, #2563eb); border-color: #60a5fa; }
        .rarity-rare { background: linear-gradient(135deg, #8b5cf6, #6d28d9); border-color: #a78bfa; }
        .rarity-epic { background: linear-gradient(135deg, #d946ef, #a21caf); border-color: #e879f9; }
        .rarity-legendary { background: linear-gradient(135deg, #ef4444, #b91c1c); border-color: #f87171; }
        .rarity-mythical { background: linear-gradient(135deg, #fbbf24, #d97706); border-color: #fcd34d; animation: mythical-pulse 2s infinite; }
        .rarity-special { background: linear-gradient(135deg, #f97316, #ea580c); border-color: #fb923c; }
        .rarity-meme { background: linear-gradient(135deg, #84cc16, #65a30d); border-color: #a3e635; }
        .rarity-godtier { background: linear-gradient(135deg, #ffd700, #ff8800, #ff00ff); border-color: #fff; animation: godtier-pulse 1s infinite; }

        @keyframes mythical-pulse { 0%, 100% { box-shadow: 0 0 20px rgba(251, 191, 36, 0.5); } 50% { box-shadow: 0 0 40px rgba(251, 191, 36, 0.8); } }
        @keyframes godtier-pulse { 0%, 100% { box-shadow: 0 0 30px rgba(255, 215, 0, 0.8); } 50% { box-shadow: 0 0 60px rgba(255, 0, 255, 0.8); } }

        /* Cases Grid */
        .cases-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px; max-height: 400px; overflow-y: auto; padding: 8px;
        }
        .cases-grid::-webkit-scrollbar { width: 8px; }
        .cases-grid::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); border-radius: 4px; }
        .cases-grid::-webkit-scrollbar-thumb { background: linear-gradient(180deg, var(--neon-blue), var(--neon-purple)); border-radius: 4px; }

        .case-card {
            background: linear-gradient(180deg, rgba(30,30,60,0.9) 0%, rgba(20,20,40,0.95) 100%);
            border: 2px solid rgba(255,255,255,0.1); border-radius: 14px; padding: 10px;
            transition: all 0.3s; cursor: pointer; position: relative;
        }
        .case-card:hover { transform: translateY(-4px) scale(1.02); box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        .case-card.selected { border-color: var(--neon-blue); box-shadow: 0 0 25px rgba(0, 240, 255, 0.4); }

        .case-image {
            width: 80px; height: 80px; display: flex; align-items: center; justify-content: center;
            margin: 0 auto 6px; border-radius: 10px; font-size: 2rem;
            background-size: contain; background-repeat: no-repeat; background-position: center;
            position: relative; overflow: hidden;
        }
        .case-image img {
            width: 100%; height: 100%; object-fit: contain;
            transition: transform 0.3s;
        }
        .case-card:hover .case-image img { transform: scale(1.1); }
        .case-image-fallback {
            width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;
            background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0.05));
            font-size: 2.5rem;
        }

        /* Roulette */
        .roulette-container {
            position: relative; overflow: hidden; border-radius: 16px;
            background: linear-gradient(180deg, rgba(0,0,0,0.9) 0%, rgba(20,20,40,0.95) 100%);
            border: 2px solid rgba(0, 240, 255, 0.3);
        }
        .roulette-strip { display: flex; will-change: transform; }
        .roulette-strip.spinning { filter: blur(2px); }

        .roulette-item {
            flex-shrink: 0; width: 120px; height: 120px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            margin: 0 4px; border-radius: 12px; border: 2px solid rgba(255,255,255,0.2);
        }

        .selector-arrow {
            position: absolute; top: -12px; left: 50%; transform: translateX(-50%);
            width: 0; height: 0; border-left: 10px solid transparent; border-right: 10px solid transparent;
            border-top: 15px solid var(--neon-blue); filter: drop-shadow(0 0 10px var(--neon-blue)); z-index: 10;
        }
        .selector-line {
            position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 3px; height: 100%; background: var(--neon-blue);
            box-shadow: 0 0 20px var(--neon-blue), 0 0 40px var(--neon-blue); z-index: 10;
        }

        /* Buttons */
        .battle-btn {
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            position: relative; overflow: hidden; transition: all 0.3s; border: none; color: white;
        }
        .battle-btn::before {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.1), transparent);
            transform: rotate(45deg); animation: btn-shine 3s infinite;
        }
        @keyframes btn-shine { 0% { transform: translateX(-100%) rotate(45deg); } 100% { transform: translateX(100%) rotate(45deg); } }
        .battle-btn:hover { transform: scale(1.05); box-shadow: 0 0 40px rgba(255, 0, 255, 0.6); }
        .battle-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }

        /* Player Cards */
        .player-card {
            background: linear-gradient(180deg, rgba(30,30,60,0.9) 0%, rgba(20,20,40,0.95) 100%);
            border: 2px solid rgba(255,255,255,0.1); border-radius: 16px;
        }

        .vs-badge {
            background: linear-gradient(135deg, #ff3366, #ff8800);
            animation: vs-pulse 1s infinite alternate;
        }
        @keyframes vs-pulse { 0% { transform: scale(1) rotate(-3deg); } 100% { transform: scale(1.1) rotate(3deg); } }

        /* Modal */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(10px);
            z-index: 2000; opacity: 0; visibility: hidden; transition: all 0.4s;
            display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .modal-overlay.open { opacity: 1; visibility: visible; }

        .modal-content {
            background: linear-gradient(180deg, rgba(20,30,50,0.98) 0%, rgba(10,20,40,0.99) 100%);
            border: 2px solid rgba(0, 240, 255, 0.3); border-radius: 20px; padding: 24px;
            max-width: 95vw; max-height: 85vh; overflow-y: auto;
            transform: scale(0.8); transition: transform 0.4s;
        }
        .modal-overlay.open .modal-content { transform: scale(1); }

        .close-btn {
            position: absolute; top: 16px; right: 16px; width: 40px; height: 40px;
            border-radius: 50%; background: linear-gradient(135deg, #ef4444, #dc2626);
            border: 2px solid white; font-size: 18px; cursor: pointer;
            display: flex; align-items: center; justify-content: center; color: white;
        }
        .close-btn:hover { transform: scale(1.1) rotate(90deg); }

        /* Slide Panels */
        .slide-panel {
            position: fixed; top: 0; bottom: 0; width: 380px; max-width: 95vw;
            background: linear-gradient(180deg, rgba(20,10,30,0.98) 0%, rgba(10,5,20,0.99) 100%);
            z-index: 2001; transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 20px; overflow-y: auto;
        }
        .slide-panel.left { left: 0; transform: translateX(-100%); border-right: 2px solid var(--neon-purple); }
        .slide-panel.right { right: 0; transform: translateX(100%); border-left: 2px solid var(--neon-blue); }
        .slide-panel.open { transform: translateX(0); }

        .slide-panel-top {
            position: fixed; top: 0; left: 0; right: 0; max-height: 90vh; overflow-y: auto;
            background: linear-gradient(180deg, rgba(20,10,30,0.98) 0%, rgba(10,5,20,0.99) 100%);
            border-bottom: 3px solid var(--neon-gold);
            z-index: 2001; transform: translateY(-100%); transition: transform 0.5s; padding: 24px;
        }
        .slide-panel-top.open { transform: translateY(0); }

        /* Settings */
        .settings-group {
            background: rgba(0,0,0,0.3); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px; padding: 14px; margin-bottom: 12px;
        }
        .settings-group h4 { font-size: 13px; color: var(--neon-purple); margin-bottom: 10px; }
        .settings-row { display: flex; align-items: center; justify-content: space-between; padding: 6px 0; }
        .settings-select {
            background: rgba(0,0,0,0.5); border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px; padding: 8px 12px; color: white; font-size: 13px;
        }

        .toggle-switch {
            position: relative; width: 44px; height: 24px; background: #333;
            border-radius: 12px; cursor: pointer; transition: all 0.3s;
        }
        .toggle-switch.active { background: linear-gradient(135deg, var(--neon-green), #00cc66); }
        .toggle-switch::after {
            content: ''; position: absolute; top: 2px; left: 2px; width: 20px; height: 20px;
            background: white; border-radius: 50%; transition: all 0.3s;
        }
        .toggle-switch.active::after { left: 22px; }

        /* Friends */
        .friend-card {
            display: flex; align-items: center; gap: 12px; padding: 12px;
            background: rgba(0,0,0,0.3); border-radius: 12px; margin-bottom: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .friend-avatar {
            width: 45px; height: 45px; border-radius: 50%;
            background: linear-gradient(135deg, var(--neon-blue), var(--neon-purple));
            display: flex; align-items: center; justify-content: center; font-size: 20px;
        }
        .friend-status { width: 12px; height: 12px; border-radius: 50%; position: absolute; bottom: 0; right: 0; border: 2px solid #1a1a2e; }
        .friend-status.online { background: #22c55e; }
        .friend-status.offline { background: #6b7280; }

        /* Transfer Modal */
        .transfer-input {
            width: 100%; padding: 12px; margin-bottom: 10px;
            background: rgba(0,0,0,0.5); border: 2px solid rgba(255,255,255,0.1);
            border-radius: 10px; color: white; font-size: 16px;
        }
        .transfer-input:focus { outline: none; border-color: var(--neon-blue); }

        /* Inventory Item */
        .inventory-item {
            width: 70px; height: 70px; display: flex; flex-direction: column;
            align-items: center; justify-content: center; border-radius: 10px;
            cursor: pointer; transition: all 0.2s; border: 2px solid rgba(255,255,255,0.2);
        }
        .inventory-item:hover { transform: scale(1.15); z-index: 10; }
        .inventory-item.selected { border-color: var(--neon-gold); box-shadow: 0 0 15px rgba(255, 215, 0, 0.5); }

        /* Notification */
        .notification-banner {
            position: fixed; top: 70px; left: 0; right: 0; z-index: 999;
            transform: translateY(-100%); transition: transform 0.5s;
        }
        .notification-banner.show { transform: translateY(0); }
        .notification-content {
            padding: 14px 20px; display: flex; align-items: center; justify-content: center;
            gap: 10px; font-weight: bold; font-size: 16px;
        }
        .notification-success { background: linear-gradient(135deg, #22c55e, #16a34a); }
        .notification-error { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .notification-info { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }

        /* Confetti */
        .confetti { position: fixed; pointer-events: none; z-index: 3000; }
        .confetti-piece { position: absolute; width: 10px; height: 10px; animation: confetti-fall 3s ease-out forwards; }
        @keyframes confetti-fall { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }

        /* Live Feed */
        .live-feed {
            position: fixed; bottom: 20px; left: 20px; width: 300px; max-height: 200px;
            background: rgba(0,0,0,0.8); border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px; overflow: hidden; z-index: 100;
        }
        .live-feed-item {
            padding: 8px 12px; border-bottom: 1px solid rgba(255,255,255,0.05);
            font-size: 12px; display: flex; align-items: center; gap: 8px;
            animation: feed-slide 0.5s ease-out;
        }
        @keyframes feed-slide { 0% { transform: translateX(-100%); opacity: 0; } 100% { transform: translateX(0); opacity: 1; } }

        @media (max-width: 768px) {
            .live-feed { display: none; }
            .header-center { display: none; }
            .header-btn span { display: none; }
        }

        /* Floating emoji */
        .floating-emoji {
            position: fixed; font-size: 40px; pointer-events: none; z-index: 3000;
            animation: emoji-float 2s ease-out forwards;
        }
        @keyframes emoji-float {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            100% { opacity: 0; transform: translateY(-200px) scale(1.5); }
        }

        /* Event Banner */
        .event-banner {
            position: fixed; top: 130px; left: 50%; transform: translateX(-50%); z-index: 500;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.95), rgba(168, 85, 247, 0.95));
            border: 2px solid #ffd700; border-radius: 16px; padding: 10px 24px;
            display: none; align-items: center; gap: 10px;
            animation: event-pulse 2s infinite;
        }
        .event-banner.show { display: flex; }
        @keyframes event-pulse { 0%, 100% { box-shadow: 0 0 40px rgba(139, 92, 246, 0.5); } 50% { box-shadow: 0 0 60px rgba(139, 92, 246, 0.8); } }
    </style>
</head>
<body class="text-white">
    <div class="bg-grid"></div>

    <!-- AUTH SCREEN -->
    <div class="auth-screen" id="authScreen">
        <div class="auth-container">
            <div class="auth-logo">‚öîÔ∏è CASE BATTLE</div>
            <p class="text-center text-gray-400 mb-6">–í–æ–π–¥–∏ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –±–∏—Ç–≤—É!</p>
            
            <div class="auth-tabs">
                <div class="auth-tab active" onclick="switchAuthTab('login')">üîê –í—Ö–æ–¥</div>
                <div class="auth-tab" onclick="switchAuthTab('register')">üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</div>
            </div>

            <!-- Login Form -->
            <div id="loginForm">
                <input type="text" class="auth-input" id="loginUsername" placeholder="üë§ –ù–∏–∫–Ω–µ–π–º" autocomplete="username">
                <input type="password" class="auth-input" id="loginPassword" placeholder="üîí –ü–∞—Ä–æ–ª—å" autocomplete="current-password">
                <button class="auth-btn" onclick="login()">üöÄ –í–æ–π—Ç–∏</button>
            </div>

            <!-- Register Form -->
            <div id="registerForm" style="display: none;">
                <input type="text" class="auth-input" id="regUsername" placeholder="üë§ –ü—Ä–∏–¥—É–º–∞–π –Ω–∏–∫–Ω–µ–π–º">
                <input type="email" class="auth-input" id="regEmail" placeholder="üìß Email (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                <input type="password" class="auth-input" id="regPassword" placeholder="üîí –ü—Ä–∏–¥—É–º–∞–π –ø–∞—Ä–æ–ª—å">
                <input type="password" class="auth-input" id="regPassword2" placeholder="üîí –ü–æ–≤—Ç–æ—Ä–∏ –ø–∞—Ä–æ–ª—å">
                <button class="auth-btn" onclick="register()">‚ú® –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
            </div>

            <div class="auth-error" id="authError"></div>
        </div>

        <div class="auth-features">
            <div class="auth-feature">
                <div class="auth-feature-icon">üì¶</div>
                <div class="auth-feature-text">100+ –∫–µ–π—Å–æ–≤</div>
            </div>
            <div class="auth-feature">
                <div class="auth-feature-icon">‚öîÔ∏è</div>
                <div class="auth-feature-text">PvP –¥—É—ç–ª–∏</div>
            </div>
            <div class="auth-feature">
                <div class="auth-feature-icon">üë•</div>
                <div class="auth-feature-text">–î—Ä—É–∑—å—è & —Ç—Ä–µ–π–¥—ã</div>
            </div>
        </div>
    </div>

    <!-- TOP HEADER -->
    <header class="top-header hidden" id="topHeader">
        <div class="header-left">
            <div class="header-logo">‚öîÔ∏è CASE BATTLE</div>
            <div class="user-profile" onclick="openProfile()">
                <div class="user-avatar" id="userAvatar">üë§</div>
                <div class="user-info">
                    <div class="user-name" id="userName">Player</div>
                    <div class="user-level">Lv. <span id="userLevel">1</span> <span id="userXpText" class="text-cyan-400 text-[10px]"></span></div>
                    <div class="xp-bar-container">
                        <div class="xp-bar" id="userXpBar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            <div class="online-counter">
                <div class="online-dot"></div>
                <span id="onlineCount">1,247</span>
            </div>
        </div>
        <div class="header-center">
            <div class="header-stat">
                <div class="header-stat-label">–ë–∞–ª–∞–Ω—Å</div>
                <div class="header-stat-value text-green-400" id="headerBalance">$10,000</div>
            </div>
            <div class="header-stat">
                <div class="header-stat-label">–ü–æ–±–µ–¥</div>
                <div class="header-stat-value text-cyan-400" id="headerWins">0</div>
            </div>
            <div class="header-stat">
                <div class="header-stat-label">Streak</div>
                <div class="header-stat-value text-orange-400" id="headerStreak">üî• 0</div>
            </div>
        </div>
        <div class="header-right">
            <button class="header-btn btn-friends" onclick="openFriends()">üë• <span>–î—Ä—É–∑—å—è</span><div class="header-badge" id="friendsBadge" style="display:none">0</div></button>
            <button class="header-btn btn-inventory" onclick="openInventory()">üéí <span>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</span><div class="header-badge" id="inventoryBadge">0</div></button>
            <button class="header-btn btn-settings" onclick="openSettings()">‚öôÔ∏è</button>
            <button class="header-btn btn-admin" id="adminBtn" onclick="openAdmin()">üîß</button>
            <button class="header-btn btn-logout" onclick="logout()">üö™</button>
        </div>
    </header>

    <!-- Notification Banner -->
    <div id="notificationBanner" class="notification-banner">
        <div id="notificationContent" class="notification-content notification-info">
            <span id="notificationText">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</span>
        </div>
    </div>

    <!-- Event Banner -->
    <div id="eventBanner" class="event-banner">
        <span class="text-xl">üéâ</span>
        <div class="font-orbitron text-xl font-bold text-yellow-400" id="eventMultiplierText">x2 –£–î–ê–ß–ê</div>
        <div class="font-orbitron text-xl text-white" id="eventTimer">05:00</div>
    </div>

    <!-- Live Feed -->
    <div class="live-feed" id="liveFeed">
        <div class="p-2 bg-gradient-to-r from-purple-600 to-pink-600 text-center font-bold text-sm">üî¥ LIVE DROPS</div>
        <div id="liveFeedItems"></div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="relative z-10 min-h-screen p-4 md:p-6" id="mainContent" style="display: none;">
        <!-- Main Tabs -->
        <div class="flex justify-center gap-3 mb-6 flex-wrap">
            <button class="main-tab active" onclick="switchMainTab('cases')" id="tabCases">üì¶ –ö–µ–π—Å—ã</button>
            <button class="main-tab" onclick="switchMainTab('battle')" id="tabBattle">‚öîÔ∏è –î—É—ç–ª—å</button>
            <button class="main-tab" onclick="switchMainTab('modes')" id="tabModes">üéÆ –†–µ–∂–∏–º—ã</button>
            <button class="main-tab" onclick="switchMainTab('tournaments')" id="tabTournaments">üèÜ –¢—É—Ä–Ω–∏—Ä—ã</button>
        </div>

        <!-- CASES SECTION -->
        <div id="casesSection" class="max-w-6xl mx-auto">
            <div class="flex gap-2 mb-4 overflow-x-auto pb-2" id="categoryTabs"></div>
            <div class="cases-grid mb-6" id="casesGrid"></div>
            
            <div class="roulette-container h-40 mb-6">
                <div class="selector-arrow"></div>
                <div class="selector-line"></div>
                <div class="roulette-strip flex items-center h-full py-2" id="soloRoulette"></div>
            </div>
            
            <div id="wonItemDisplay" class="text-center mb-6 hidden">
                <div class="inline-block p-6 rounded-2xl border-2" id="wonItemCard">
                    <div class="text-5xl mb-2" id="wonItemIcon">üéÅ</div>
                    <div class="font-orbitron text-xl font-bold" id="wonItemName">–ü—Ä–µ–¥–º–µ—Ç</div>
                    <div class="font-orbitron text-2xl text-green-400" id="wonItemValue">$0</div>
                </div>
            </div>
            
            <div class="flex justify-center gap-4 flex-wrap">
                <button id="openCaseBtn" onclick="openCase()" class="battle-btn px-10 py-4 rounded-xl font-orbitron font-bold text-lg">
                    üì¶ –û—Ç–∫—Ä—ã—Ç—å ‚Äî <span id="casePriceText">$50</span>
                </button>
                <label class="flex items-center gap-2 bg-gray-800 px-4 py-2 rounded-xl cursor-pointer">
                    <input type="checkbox" id="fastModeCheck" class="w-4 h-4">
                    <span class="text-sm">‚ö° Fast Mode</span>
                </label>
            </div>
        </div>

        <!-- BATTLE SECTION -->
        <div id="battleSection" class="max-w-6xl mx-auto hidden">
            <div class="text-center mb-4">
                <span class="text-gray-400">–†–∞—É–Ω–¥: </span>
                <span class="font-orbitron text-xl text-purple-400"><span id="currentRound">1</span>/<span id="totalRounds">5</span></span>
            </div>
            
            <div class="grid md:grid-cols-2 gap-6 relative">
                <!-- Player 1 -->
                <div class="player-card p-5" id="player1Card">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-cyan-400 to-blue-600 flex items-center justify-center text-2xl" id="p1Avatar">üë§</div>
                            <div>
                                <div class="font-orbitron font-bold text-cyan-400" id="p1Name">–¢–´</div>
                                <div class="text-xs text-gray-400">Lv. <span id="p1Level">1</span></div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-gray-400 text-sm">–í—ã–∏–≥—Ä—ã—à</div>
                            <div class="font-orbitron text-2xl text-green-400" id="player1Score">$0.00</div>
                        </div>
                    </div>
                    <div class="roulette-container h-32 mb-4">
                        <div class="selector-arrow"></div>
                        <div class="selector-line"></div>
                        <div class="roulette-strip flex items-center h-full py-2" id="roulette1"></div>
                    </div>
                    <div class="flex flex-wrap gap-2 min-h-[50px]" id="player1Items"></div>
                </div>

                <!-- VS Badge -->
                <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 z-20 hidden md:block">
                    <div class="vs-badge w-16 h-16 rounded-full flex items-center justify-center font-orbitron font-black text-xl text-white shadow-2xl">VS</div>
                </div>

                <!-- Player 2 -->
                <div class="player-card p-5">
                    <div class="flex items-center justify-between mb-4">
                        <div class="flex items-center gap-3">
                            <div class="w-12 h-12 rounded-full bg-gradient-to-br from-pink-400 to-red-600 flex items-center justify-center text-2xl">ü§ñ</div>
                            <div>
                                <div class="font-orbitron font-bold text-pink-400">–ë–û–¢</div>
                                <div class="text-xs text-gray-400">Lv. <span id="p2Level">5</span></div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="text-gray-400 text-sm">–í—ã–∏–≥—Ä—ã—à</div>
                            <div class="font-orbitron text-2xl text-green-400" id="player2Score">$0.00</div>
                        </div>
                    </div>
                    <div class="roulette-container h-32 mb-4">
                        <div class="selector-arrow" style="border-top-color: var(--neon-pink);"></div>
                        <div class="selector-line" style="background: var(--neon-pink); box-shadow: 0 0 20px var(--neon-pink);"></div>
                        <div class="roulette-strip flex items-center h-full py-2" id="roulette2"></div>
                    </div>
                    <div class="flex flex-wrap gap-2 min-h-[50px]" id="player2Items"></div>
                </div>
            </div>

            <!-- Emoji Reactions -->
            <div class="flex justify-center gap-3 my-4">
                <span class="text-2xl cursor-pointer hover:scale-125 transition-transform" onclick="sendEmoji('üî•')">üî•</span>
                <span class="text-2xl cursor-pointer hover:scale-125 transition-transform" onclick="sendEmoji('üí©')">üí©</span>
                <span class="text-2xl cursor-pointer hover:scale-125 transition-transform" onclick="sendEmoji('ü§°')">ü§°</span>
                <span class="text-2xl cursor-pointer hover:scale-125 transition-transform" onclick="sendEmoji('üòÇ')">üòÇ</span>
                <span class="text-2xl cursor-pointer hover:scale-125 transition-transform" onclick="sendEmoji('üéâ')">üéâ</span>
                <span class="text-2xl cursor-pointer hover:scale-125 transition-transform" onclick="sendEmoji('üëë')">üëë</span>
            </div>

            <div class="flex flex-col items-center gap-4">
                <button id="battleBtn" onclick="startBattle()" class="battle-btn px-10 py-4 rounded-xl font-orbitron font-bold text-lg">‚öîÔ∏è –ù–∞—á–∞—Ç—å –ë–∏—Ç–≤—É</button>
                <button onclick="resetBattle()" class="px-6 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 text-sm">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
            </div>
        </div>

        <!-- MODES SECTION -->
        <div id="modesSection" class="max-w-6xl mx-auto hidden">
            <h2 class="font-orbitron text-2xl font-bold text-center mb-6">üéÆ –ò–≥—Ä–æ–≤—ã–µ —Ä–µ–∂–∏–º—ã</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div class="p-4 bg-gradient-to-br from-blue-600/20 to-cyan-600/20 border border-blue-500/30 rounded-xl cursor-pointer hover:scale-105 transition-all">
                    <div class="text-3xl mb-2">‚öîÔ∏è</div>
                    <h3 class="font-bold">–ö–ª–∞—Å—Å–∏–∫–∞ 1v1</h3>
                    <p class="text-xs text-gray-400">–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –¥—É—ç–ª—å</p>
                </div>
                <div class="p-4 bg-gradient-to-br from-purple-600/20 to-pink-600/20 border border-purple-500/30 rounded-xl cursor-pointer hover:scale-105 transition-all">
                    <div class="text-3xl mb-2">üë•</div>
                    <h3 class="font-bold">Team Battle</h3>
                    <p class="text-xs text-gray-400">2v2, 3v3</p>
                </div>
                <div class="p-4 bg-gradient-to-br from-yellow-600/20 to-orange-600/20 border border-yellow-500/30 rounded-xl cursor-pointer hover:scale-105 transition-all">
                    <div class="text-3xl mb-2">üëë</div>
                    <h3 class="font-bold">Battle Royale</h3>
                    <p class="text-xs text-gray-400">–î–æ 10 –∏–≥—Ä–æ–∫–æ–≤</p>
                </div>
                <div class="p-4 bg-gradient-to-br from-red-600/20 to-pink-600/20 border border-red-500/30 rounded-xl cursor-pointer hover:scale-105 transition-all">
                    <div class="text-3xl mb-2">üîÆ</div>
                    <h3 class="font-bold">Cursed Mode</h3>
                    <p class="text-xs text-gray-400">–ú–µ–Ω—å—à–µ = –ø–æ–±–µ–¥–∞</p>
                </div>
            </div>
        </div>

        <!-- TOURNAMENTS SECTION -->
        <div id="tournamentsSection" class="max-w-6xl mx-auto hidden">
            <h2 class="font-orbitron text-2xl font-bold text-center mb-6">üèÜ –¢—É—Ä–Ω–∏—Ä—ã</h2>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="p-4 bg-gradient-to-br from-yellow-600/20 to-orange-600/20 border border-yellow-500/30 rounded-xl">
                    <div class="text-2xl mb-2">ü•á</div>
                    <h3 class="font-bold text-yellow-400">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π</h3>
                    <p class="text-sm text-gray-400 mb-2">–ü—Ä–∏–∑: $1,000</p>
                    <button class="w-full py-2 bg-yellow-600 rounded-lg font-bold text-sm">–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</button>
                </div>
                <div class="p-4 bg-gradient-to-br from-purple-600/20 to-pink-600/20 border border-purple-500/30 rounded-xl">
                    <div class="text-2xl mb-2">üèÜ</div>
                    <h3 class="font-bold text-purple-400">–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π</h3>
                    <p class="text-sm text-gray-400 mb-2">–ü—Ä–∏–∑: $10,000</p>
                    <button class="w-full py-2 bg-purple-600 rounded-lg font-bold text-sm">–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</button>
                </div>
                <div class="p-4 bg-gradient-to-br from-cyan-600/20 to-blue-600/20 border border-cyan-500/30 rounded-xl">
                    <div class="text-2xl mb-2">üëë</div>
                    <h3 class="font-bold text-cyan-400">–°–µ–∑–æ–Ω–Ω—ã–π</h3>
                    <p class="text-sm text-gray-400 mb-2">–ü—Ä–∏–∑: $100,000</p>
                    <button class="w-full py-2 bg-cyan-600 rounded-lg font-bold text-sm">–£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- INVENTORY MODAL -->
    <div class="modal-overlay" id="inventoryModal" onclick="closeInventory(event)">
        <div class="modal-content w-full max-w-4xl relative" onclick="event.stopPropagation()">
            <button class="close-btn" onclick="closeInventory()">‚úï</button>
            <h2 class="font-orbitron text-2xl font-bold text-cyan-400 mb-4">üéí –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
            <div class="flex items-center justify-between mb-4 p-4 bg-black/30 rounded-xl flex-wrap gap-4">
                <div class="flex gap-6">
                    <div><span class="text-gray-400 text-sm">–ü—Ä–µ–¥–º–µ—Ç–æ–≤:</span><span id="invCount" class="text-white font-bold text-xl ml-2">0</span></div>
                    <div><span class="text-gray-400 text-sm">–°—Ç–æ–∏–º–æ—Å—Ç—å:</span><span id="invValue" class="text-green-400 font-bold text-xl ml-2">$0</span></div>
                </div>
                <div class="flex gap-2">
                    <button onclick="sellSelected()" class="px-4 py-2 rounded-lg bg-orange-600 font-bold text-sm">–ü—Ä–æ–¥–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</button>
                    <button onclick="sellAll()" class="px-4 py-2 rounded-lg bg-red-600 font-bold text-sm">–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë</button>
                    <button onclick="openSendItems()" class="px-4 py-2 rounded-lg bg-purple-600 font-bold text-sm">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥—Ä—É–≥—É</button>
                </div>
            </div>
            <div id="inventoryGrid" class="grid grid-cols-6 sm:grid-cols-8 md:grid-cols-10 gap-2 min-h-[200px] p-4 bg-black/30 rounded-xl">
                <div class="col-span-full text-center text-gray-500 py-10">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>
            </div>
        </div>
    </div>

    <!-- FRIENDS MODAL -->
    <div class="modal-overlay" id="friendsModal" onclick="closeFriends(event)">
        <div class="modal-content w-full max-w-2xl relative" onclick="event.stopPropagation()">
            <button class="close-btn" onclick="closeFriends()">‚úï</button>
            <h2 class="font-orbitron text-2xl font-bold text-pink-400 mb-4">üë• –î—Ä—É–∑—å—è</h2>
            
            <!-- Add Friend -->
            <div class="flex gap-2 mb-6">
                <input type="text" id="addFriendInput" placeholder="–í–≤–µ–¥–∏ –Ω–∏–∫–Ω–µ–π–º –¥—Ä—É–≥–∞..." class="flex-1 bg-black/50 border border-gray-700 rounded-lg px-4 py-3 text-white">
                <button onclick="addFriend()" class="px-6 py-3 bg-green-600 hover:bg-green-500 rounded-lg font-bold">‚ûï –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>

            <!-- Friend Requests -->
            <div id="friendRequests" class="mb-6 hidden">
                <h3 class="font-bold text-yellow-400 mb-3">üì® –ó–∞—è–≤–∫–∏ –≤ –¥—Ä—É–∑—å—è</h3>
                <div id="friendRequestsList"></div>
            </div>

            <!-- Friends List -->
            <h3 class="font-bold text-cyan-400 mb-3">üéÆ –ú–æ–∏ –¥—Ä—É–∑—å—è</h3>
            <div id="friendsList">
                <div class="text-center text-gray-500 py-6">–£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π üò¢</div>
            </div>
        </div>
    </div>

    <!-- SEND MONEY MODAL -->
    <div class="modal-overlay" id="sendMoneyModal" onclick="closeSendMoney(event)">
        <div class="modal-content w-full max-w-md relative" onclick="event.stopPropagation()">
            <button class="close-btn" onclick="closeSendMoney()">‚úï</button>
            <h2 class="font-orbitron text-xl font-bold text-green-400 mb-4">üí∏ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–µ–Ω—å–≥–∏</h2>
            <p class="text-gray-400 mb-4">–û—Ç–ø—Ä–∞–≤–∏—Ç—å: <span id="sendMoneyTo" class="text-white font-bold"></span></p>
            <input type="number" id="sendMoneyAmount" placeholder="–°—É–º–º–∞..." class="transfer-input" min="1">
            <button onclick="confirmSendMoney()" class="w-full py-3 bg-green-600 hover:bg-green-500 rounded-lg font-bold mt-2">üí∞ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <!-- SEND ITEMS MODAL -->
    <div class="modal-overlay" id="sendItemsModal" onclick="closeSendItems(event)">
        <div class="modal-content w-full max-w-md relative" onclick="event.stopPropagation()">
            <button class="close-btn" onclick="closeSendItems()">‚úï</button>
            <h2 class="font-orbitron text-xl font-bold text-purple-400 mb-4">üì¶ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥–º–µ—Ç—ã</h2>
            <p class="text-gray-400 mb-2">–í—ã–±—Ä–∞–Ω–æ –ø—Ä–µ–¥–º–µ—Ç–æ–≤: <span id="selectedItemsCount" class="text-white font-bold">0</span></p>
            <select id="sendItemsTo" class="transfer-input mb-4">
                <option value="">–í—ã–±–µ—Ä–∏ –¥—Ä—É–≥–∞...</option>
            </select>
            <button onclick="confirmSendItems()" class="w-full py-3 bg-purple-600 hover:bg-purple-500 rounded-lg font-bold">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <!-- SETTINGS PANEL -->
    <div class="modal-overlay" id="settingsOverlay" onclick="closeSettings()"></div>
    <div class="slide-panel left" id="settingsPanel">
        <button class="close-btn" onclick="closeSettings()">‚úï</button>
        <h2 class="font-orbitron text-xl font-bold text-purple-400 mb-4">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        
        <div class="settings-group">
            <h4>üîä –ó–≤—É–∫</h4>
            <div class="settings-row"><span>–≠—Ñ—Ñ–µ–∫—Ç—ã</span><div id="soundToggle" class="toggle-switch active" onclick="toggleSound()"></div></div>
        </div>
        <div class="settings-group">
            <h4>‚ö° –°–∫–æ—Ä–æ—Å—Ç—å —Ä—É–ª–µ—Ç–∫–∏</h4>
            <select class="settings-select w-full" id="speedSelect" onchange="updateSpeed()">
                <option value="7">üê¢ –ú–µ–¥–ª–µ–Ω–Ω–æ</option>
                <option value="5" selected>üö∂ –ù–æ—Ä–º–∞–ª—å–Ω–æ</option>
                <option value="3">üèÉ –ë—ã—Å—Ç—Ä–æ</option>
                <option value="1">‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ</option>
            </select>
        </div>
        <div class="settings-group">
            <h4>‚ú® –≠—Ñ—Ñ–µ–∫—Ç—ã</h4>
            <div class="settings-row"><span>–ö–æ–Ω—Ñ–µ—Ç—Ç–∏</span><div id="confettiToggle" class="toggle-switch active" onclick="toggleConfetti()"></div></div>
        </div>
        <div class="settings-group">
            <h4>üéÆ –†–∞—É–Ω–¥–æ–≤ –≤ –¥—É—ç–ª–∏</h4>
            <select class="settings-select w-full" id="roundsSelect" onchange="updateRounds()">
                <option value="3">3</option>
                <option value="5" selected>5</option>
                <option value="7">7</option>
                <option value="10">10</option>
            </select>
        </div>
    </div>

    <!-- ADMIN PANEL -->
    <div class="modal-overlay" id="adminOverlay" onclick="closeAdmin()"></div>
    <div class="slide-panel-top" id="adminPanel">
        <button class="close-btn" onclick="closeAdmin()">‚úï</button>
        <div class="max-w-6xl mx-auto">
            <h2 class="font-orbitron text-2xl font-bold text-yellow-400 mb-6">üîß –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å & Dev Tools</h2>
            <div class="grid md:grid-cols-4 gap-4">
                <!-- –ë–∞–ª–∞–Ω—Å -->
                <div class="p-4 bg-black/30 rounded-xl">
                    <h3 class="font-bold text-green-400 mb-3">üíµ –ë–∞–ª–∞–Ω—Å</h3>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="addMoney(1000)" class="px-2 py-2 bg-green-700 rounded-lg text-xs font-bold">+$1K</button>
                        <button onclick="addMoney(10000)" class="px-2 py-2 bg-green-600 rounded-lg text-xs font-bold">+$10K</button>
                        <button onclick="addMoney(100000)" class="px-2 py-2 bg-green-500 rounded-lg text-xs font-bold">+$100K</button>
                        <button onclick="addMoney(1000000)" class="px-2 py-2 bg-yellow-600 rounded-lg text-xs font-bold">+$1M</button>
                    </div>
                </div>
                
                <!-- –ü—Ä–µ–¥–º–µ—Ç—ã -->
                <div class="p-4 bg-black/30 rounded-xl">
                    <h3 class="font-bold text-purple-400 mb-3">üéÅ –ü—Ä–µ–¥–º–µ—Ç—ã</h3>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="addRandomItem('legendary')" class="px-2 py-2 bg-red-600 rounded-lg text-xs font-bold">Legendary</button>
                        <button onclick="addRandomItem('mythical')" class="px-2 py-2 bg-yellow-600 rounded-lg text-xs font-bold">Mythical</button>
                        <button onclick="addRandomItem('godtier')" class="col-span-2 px-2 py-2 bg-gradient-to-r from-yellow-500 to-pink-500 rounded-lg text-xs font-bold">üëë God Tier</button>
                    </div>
                </div>
                
                <!-- –ë—ã—Å—Ç—Ä—ã–µ -->
                <div class="p-4 bg-black/30 rounded-xl">
                    <h3 class="font-bold text-pink-400 mb-3">‚ö° –ë—ã—Å—Ç—Ä—ã–µ</h3>
                    <button onclick="godMode()" class="w-full px-3 py-2 bg-gradient-to-r from-yellow-500 to-pink-500 rounded-lg text-sm font-bold mb-2">üëë GOD MODE</button>
                    <button onclick="clearAllData()" class="w-full px-3 py-2 bg-red-700 rounded-lg text-xs font-bold">üóëÔ∏è –°–±—Ä–æ—Å –≤—Å–µ–≥–æ</button>
                </div>
                
                <!-- –£–¥–∞—á–∞ -->
                <div class="p-4 bg-black/30 rounded-xl">
                    <h3 class="font-bold text-cyan-400 mb-3">üçÄ –£–¥–∞—á–∞</h3>
                    <div class="flex items-center gap-2 mb-2">
                        <input type="range" id="luckSlider" min="1" max="100" value="1" class="flex-1" onchange="setLuckMult(this.value)">
                        <span id="luckValue" class="text-yellow-400 font-bold">x1</span>
                    </div>
                    <button onclick="setLuckMult(10)" class="w-full px-3 py-1 bg-cyan-600 rounded-lg text-xs font-bold">x10 –£–¥–∞—á–∞</button>
                </div>
            </div>
            
            <!-- DEV TOOLS -->
            <h3 class="font-orbitron text-xl font-bold text-orange-400 mt-6 mb-4">üõ†Ô∏è Dev Tools</h3>
            <div class="grid md:grid-cols-2 gap-4">
                <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                <div class="p-4 bg-black/30 rounded-xl">
                    <h4 class="font-bold text-yellow-400 mb-3">üì¢ –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h4>
                    <input type="text" id="globalNotifText" placeholder="–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è..." class="w-full bg-black/50 border border-gray-700 rounded-lg px-3 py-2 text-white mb-2 text-sm">
                    <div class="flex gap-2 mb-3">
                        <select id="globalNotifType" class="flex-1 bg-black/50 border border-gray-700 rounded-lg px-2 py-2 text-white text-sm">
                            <option value="info">‚ÑπÔ∏è –ò–Ω—Ñ–æ</option>
                            <option value="success">‚úÖ –£—Å–ø–µ—Ö</option>
                            <option value="error">‚ùå –í–∞–∂–Ω–æ</option>
                        </select>
                        <button onclick="sendCustomNotification()" class="px-4 py-2 bg-blue-600 rounded-lg font-bold text-sm">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                    <div class="text-xs text-gray-400 mb-2">–ì–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã:</div>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="sendGlobalNotification('üéâ –ò–í–ï–ù–¢ –ù–ê–ß–ê–õ–°–Ø! –ü–æ–≤—ã—à–µ–Ω–Ω–∞—è —É–¥–∞—á–∞!', 'success')" class="px-2 py-2 bg-green-700 rounded-lg text-xs">üéâ –ù–∞—á–∞–ª–æ –∏–≤–µ–Ω—Ç–∞</button>
                        <button onclick="sendGlobalNotification('üèÅ –ò–≤–µ–Ω—Ç –∑–∞–≤–µ—Ä—à—ë–Ω. –°–ø–∞—Å–∏–±–æ!', 'info')" class="px-2 py-2 bg-gray-700 rounded-lg text-xs">üèÅ –ö–æ–Ω–µ—Ü –∏–≤–µ–Ω—Ç–∞</button>
                        <button onclick="sendGlobalNotification('üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Case Battle Arena!', 'info')" class="px-2 py-2 bg-blue-700 rounded-lg text-xs">üëã –í—Å–µ–º –ø—Ä–∏–≤–µ—Ç</button>
                        <button onclick="sendGlobalNotification('üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç!', 'error')" class="px-2 py-2 bg-red-700 rounded-lg text-xs">üîß –¢–µ—Ö. —Ä–∞–±–æ—Ç—ã</button>
                        <button onclick="sendGlobalNotification('üÜï –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∫–µ–π—Å—ã! –ó–∞—Ö–æ–¥–∏—Ç–µ!', 'success')" class="px-2 py-2 bg-purple-700 rounded-lg text-xs">üÜï –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ</button>
                        <button onclick="sendGlobalNotification('üéÅ –ë–û–ù–£–° –í–°–ï–ú! +$1000 –Ω–∞ –±–∞–ª–∞–Ω—Å!', 'success')" class="px-2 py-2 bg-yellow-700 rounded-lg text-xs">üéÅ –ë–æ–Ω—É—Å –≤—Å–µ–º</button>
                    </div>
                </div>
                
                <!-- –ò–≤–µ–Ω—Ç—ã -->
                <div class="p-4 bg-black/30 rounded-xl">
                    <h4 class="font-bold text-pink-400 mb-3">üéä –ò–≤–µ–Ω—Ç—ã —É–¥–∞—á–∏</h4>
                    <div class="flex gap-2 mb-3">
                        <select id="eventDuration" class="flex-1 bg-black/50 border border-gray-700 rounded-lg px-2 py-2 text-white text-sm">
                            <option value="1">1 –º–∏–Ω</option>
                            <option value="5" selected>5 –º–∏–Ω</option>
                            <option value="10">10 –º–∏–Ω</option>
                            <option value="30">30 –º–∏–Ω</option>
                            <option value="60">1 —á–∞—Å</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-2 gap-2 mb-3">
                        <button onclick="startEvent(2, 'x2 –£–î–ê–ß–ê üçÄ')" class="px-2 py-2 bg-green-600 rounded-lg text-xs font-bold">üçÄ x2 –£–¥–∞—á–∞</button>
                        <button onclick="startEvent(5, 'x5 –£–î–ê–ß–ê ‚≠ê')" class="px-2 py-2 bg-blue-600 rounded-lg text-xs font-bold">‚≠ê x5 –£–¥–∞—á–∞</button>
                        <button onclick="startEvent(10, 'x10 –£–î–ê–ß–ê üíé')" class="px-2 py-2 bg-purple-600 rounded-lg text-xs font-bold">üíé x10 –£–¥–∞—á–∞</button>
                        <button onclick="startEvent(100, 'x100 –£–î–ê–ß–ê üëë')" class="px-2 py-2 bg-gradient-to-r from-yellow-500 to-pink-500 rounded-lg text-xs font-bold">üëë x100 –£–¥–∞—á–∞</button>
                    </div>
                    <button onclick="stopEvent()" class="w-full px-3 py-2 bg-red-600 rounded-lg text-sm font-bold">üõë –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–≤–µ–Ω—Ç</button>
                    <div class="mt-3 text-center">
                        <span class="text-gray-400 text-sm">–°—Ç–∞—Ç—É—Å: </span>
                        <span id="eventStatus" class="text-gray-500 text-sm">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–≤–µ–Ω—Ç–∞</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="confettiContainer" class="confetti"></div>

    <!-- Footer -->
    <footer class="relative z-10 mt-8 border-t border-gray-800" id="mainFooter" style="display: none;">
        <div class="max-w-4xl mx-auto px-4 py-8">
            <div class="text-center mb-6">
                <p class="text-3xl font-orbitron text-transparent bg-clip-text bg-gradient-to-r from-pink-500 via-purple-500 to-cyan-500 animate-pulse">üé≠ –≠–¢–û –®–£–¢–ö–ê üé≠</p>
                <p class="text-gray-500 text-sm mt-2">–í—Å–µ –¥–µ–Ω—å–≥–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ!</p>
            </div>
            <div id="adminLoginSection" class="mb-6">
                <div class="bg-black/30 rounded-xl p-4 max-w-sm mx-auto">
                    <h3 class="font-bold text-yellow-400 mb-3 text-center">üîê –ê–¥–º–∏–Ω –¥–æ—Å—Ç—É–ø</h3>
                    <div class="flex gap-2">
                        <input type="password" id="adminPass" placeholder="–ü–∞—Ä–æ–ª—å..." class="flex-1 bg-black/50 border border-gray-700 rounded-lg px-3 py-2 text-white">
                        <button onclick="adminLogin()" class="px-4 py-2 bg-yellow-600 rounded-lg font-bold">–í–æ–π—Ç–∏</button>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // ==================== DATABASE (localStorage) ====================
        const DB = {
            getUsers: () => JSON.parse(localStorage.getItem('cb_users') || '{}'),
            saveUsers: (users) => localStorage.setItem('cb_users', JSON.stringify(users)),
            getCurrentUser: () => localStorage.getItem('cb_currentUser'),
            setCurrentUser: (username) => localStorage.setItem('cb_currentUser', username),
            clearCurrentUser: () => localStorage.removeItem('cb_currentUser'),
            
            // –ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
            findUserKey: (username) => {
                const users = DB.getUsers();
                const lowerUsername = username.toLowerCase();
                return Object.keys(users).find(key => key.toLowerCase() === lowerUsername);
            },
            
            getUser: (username) => {
                const users = DB.getUsers();
                // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
                if (users[username]) return users[username];
                // –ü–æ—Ç–æ–º –∏—â–µ–º –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
                const key = DB.findUserKey(username);
                return key ? users[key] : null;
            },
            
            saveUser: (username, data) => {
                const users = DB.getUsers();
                // –ò—â–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–ª—é—á –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
                const existingKey = DB.findUserKey(username);
                const key = existingKey || username;
                users[key] = data;
                DB.saveUsers(users);
            },
            
            createUser: (username, password, email = '') => {
                const users = DB.getUsers();
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
                if (DB.findUserKey(username)) return false;
                
                users[username] = {
                    username,
                    password,
                    email,
                    balance: 10000,
                    inventory: [],
                    wins: 0,
                    streak: 0,
                    level: 1,
                    xp: 0,
                    casesOpened: 0,
                    friends: [],
                    friendRequests: [],
                    avatar: 'üë§',
                    createdAt: Date.now(),
                    lastOnline: Date.now()
                };
                
                DB.saveUsers(users);
                return true;
            }
        };

        // ==================== GAME DATA ====================
        const categories = { 
            all: 'üåü –í—Å–µ', basic: 'üì¶ –ë–∞–∑–æ–≤—ã–µ', premium: 'üíé –ü—Ä–µ–º–∏—É–º', 
            ranks: 'üéñÔ∏è –ó–≤–∞–Ω–∏—è', weapons: 'üî´ –û—Ä—É–∂–∏–µ', knives: 'üî™ –ù–æ–∂–∏',
            gloves: 'üß§ –ü–µ—Ä—á–∞—Ç–∫–∏', memes: 'üòÇ –ú–µ–º—ã', special: '‚ú® –û—Å–æ–±—ã–µ',
            ultra: 'üëë –£–ª—å—Ç—Ä–∞', god: '‚ö° –ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ'
        };

        // –ö–∞—Ä—Ç–∏–Ω–∫–∏ –∫–µ–π—Å–æ–≤ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ emoji fallback –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏
        // Steam CDN —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫—Ä–∞—Å–∏–≤—ã–µ —ç–º–æ–¥–∑–∏
        const caseImages = {};

        const allCases = [
            // ===== –ë–ê–ó–û–í–´–ï =====
            { id: 'bomzh', name: '–ë–æ–º–∂', price: 5, category: 'basic', color: 'from-gray-600 to-gray-800', mult: 0.3 },
            { id: 'budget', name: '–ë—é–¥–∂–µ—Ç–Ω—ã–π', price: 15, category: 'basic', color: 'from-gray-500 to-gray-700', mult: 0.5 },
            { id: 'standard', name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç', price: 50, category: 'basic', color: 'from-blue-600 to-blue-800', mult: 1 },
            { id: 'premium', name: '–ü—Ä–µ–º–∏—É–º', price: 150, category: 'premium', color: 'from-purple-600 to-purple-800', mult: 2 },
            { id: 'legendary', name: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π', price: 500, category: 'premium', color: 'from-yellow-500 to-orange-600', mult: 5 },
            { id: 'major', name: '–ú–∞–∂–æ—Ä', price: 2000, category: 'premium', color: 'from-green-400 to-emerald-600', mult: 15 },
            { id: 'godlike', name: '–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π', price: 10000, category: 'premium', color: 'from-pink-500 to-rose-600', mult: 50 },
            
            // ===== –ó–í–ê–ù–ò–Ø CS:GO (18 —à—Ç—É–∫) =====
            { id: 'silver1', name: 'Silver I', price: 10, category: 'ranks', color: 'from-gray-400 to-gray-600', mult: 0.4 },
            { id: 'silver2', name: 'Silver II', price: 15, category: 'ranks', color: 'from-gray-400 to-gray-600', mult: 0.5 },
            { id: 'silver3', name: 'Silver III', price: 20, category: 'ranks', color: 'from-gray-400 to-gray-600', mult: 0.6 },
            { id: 'silver4', name: 'Silver IV', price: 25, category: 'ranks', color: 'from-gray-400 to-gray-600', mult: 0.7 },
            { id: 'silverelite', name: 'Silver Elite', price: 35, category: 'ranks', color: 'from-gray-500 to-gray-700', mult: 0.8 },
            { id: 'silverelitemaster', name: 'Silver Elite Master', price: 50, category: 'ranks', color: 'from-gray-500 to-gray-700', mult: 1 },
            { id: 'gold1', name: 'Gold Nova I', price: 75, category: 'ranks', color: 'from-yellow-500 to-yellow-700', mult: 1.5 },
            { id: 'gold2', name: 'Gold Nova II', price: 100, category: 'ranks', color: 'from-yellow-500 to-yellow-700', mult: 2 },
            { id: 'gold3', name: 'Gold Nova III', price: 150, category: 'ranks', color: 'from-yellow-500 to-yellow-700', mult: 2.5 },
            { id: 'goldmaster', name: 'Gold Nova Master', price: 200, category: 'ranks', color: 'from-yellow-400 to-amber-600', mult: 3 },
            { id: 'mg1', name: 'Master Guardian I', price: 300, category: 'ranks', color: 'from-blue-400 to-blue-600', mult: 4 },
            { id: 'mg2', name: 'Master Guardian II', price: 400, category: 'ranks', color: 'from-blue-400 to-blue-600', mult: 5 },
            { id: 'mge', name: 'MG Elite', price: 500, category: 'ranks', color: 'from-blue-500 to-indigo-600', mult: 6 },
            { id: 'dmg', name: 'Distinguished MG', price: 750, category: 'ranks', color: 'from-indigo-500 to-purple-600', mult: 8 },
            { id: 'le', name: 'Legendary Eagle', price: 1000, category: 'ranks', color: 'from-purple-500 to-pink-600', mult: 12 },
            { id: 'lem', name: 'Legendary Eagle Master', price: 1500, category: 'ranks', color: 'from-purple-600 to-pink-600', mult: 18 },
            { id: 'supreme', name: 'Supreme Master', price: 2500, category: 'ranks', color: 'from-red-500 to-orange-500', mult: 30 },
            { id: 'global', name: 'Global Elite', price: 5000, category: 'ranks', color: 'from-yellow-400 to-red-500', mult: 50 },
            
            // ===== –û–†–£–ñ–ò–ï CS:GO (20 —à—Ç—É–∫) =====
            { id: 'glock', name: 'Glock-18', price: 30, category: 'weapons', color: 'from-gray-500 to-gray-700', mult: 0.8 },
            { id: 'usps', name: 'USP-S', price: 40, category: 'weapons', color: 'from-gray-500 to-gray-700', mult: 0.9 },
            { id: 'p250', name: 'P250', price: 25, category: 'weapons', color: 'from-gray-500 to-gray-700', mult: 0.6 },
            { id: 'deagle', name: 'Desert Eagle', price: 100, category: 'weapons', color: 'from-yellow-600 to-amber-700', mult: 2 },
            { id: 'r8', name: 'R8 Revolver', price: 80, category: 'weapons', color: 'from-amber-600 to-orange-700', mult: 1.5 },
            { id: 'mac10', name: 'MAC-10', price: 35, category: 'weapons', color: 'from-green-600 to-green-800', mult: 0.7 },
            { id: 'mp9', name: 'MP9', price: 35, category: 'weapons', color: 'from-blue-600 to-blue-800', mult: 0.7 },
            { id: 'ump45', name: 'UMP-45', price: 50, category: 'weapons', color: 'from-gray-600 to-gray-800', mult: 1 },
            { id: 'p90', name: 'P90', price: 75, category: 'weapons', color: 'from-orange-500 to-red-600', mult: 1.3 },
            { id: 'famas', name: 'FAMAS', price: 60, category: 'weapons', color: 'from-blue-500 to-indigo-600', mult: 1.1 },
            { id: 'galil', name: 'Galil AR', price: 55, category: 'weapons', color: 'from-green-500 to-teal-600', mult: 1 },
            { id: 'ak47', name: 'AK-47', price: 100, category: 'weapons', color: 'from-orange-600 to-red-700', mult: 1.5 },
            { id: 'm4a4', name: 'M4A4', price: 120, category: 'weapons', color: 'from-blue-600 to-purple-700', mult: 1.8 },
            { id: 'm4a1s', name: 'M4A1-S', price: 130, category: 'weapons', color: 'from-gray-600 to-blue-700', mult: 2 },
            { id: 'aug', name: 'AUG', price: 90, category: 'weapons', color: 'from-green-600 to-emerald-700', mult: 1.4 },
            { id: 'sg553', name: 'SG 553', price: 85, category: 'weapons', color: 'from-purple-600 to-violet-700', mult: 1.3 },
            { id: 'ssg08', name: 'SSG 08', price: 70, category: 'weapons', color: 'from-cyan-600 to-blue-700', mult: 1.2 },
            { id: 'awp', name: 'AWP', price: 200, category: 'weapons', color: 'from-green-600 to-teal-700', mult: 3 },
            { id: 'scar20', name: 'SCAR-20', price: 150, category: 'weapons', color: 'from-yellow-600 to-orange-700', mult: 2.2 },
            { id: 'negev', name: 'Negev', price: 180, category: 'weapons', color: 'from-red-600 to-pink-700', mult: 2.5 },
            
            // ===== –ù–û–ñ–ò (15 —à—Ç—É–∫) =====
            { id: 'karambit', name: 'Karambit', price: 1500, category: 'knives', color: 'from-red-600 to-orange-600', mult: 20 },
            { id: 'butterfly', name: 'Butterfly', price: 1200, category: 'knives', color: 'from-purple-600 to-pink-600', mult: 15 },
            { id: 'm9bayonet', name: 'M9 Bayonet', price: 1300, category: 'knives', color: 'from-gray-600 to-blue-600', mult: 17 },
            { id: 'bayonet', name: 'Bayonet', price: 800, category: 'knives', color: 'from-gray-500 to-gray-700', mult: 10 },
            { id: 'flip', name: 'Flip Knife', price: 600, category: 'knives', color: 'from-blue-500 to-cyan-600', mult: 8 },
            { id: 'gut', name: 'Gut Knife', price: 400, category: 'knives', color: 'from-green-500 to-teal-600', mult: 5 },
            { id: 'falchion', name: 'Falchion', price: 500, category: 'knives', color: 'from-yellow-500 to-amber-600', mult: 6 },
            { id: 'bowie', name: 'Bowie Knife', price: 550, category: 'knives', color: 'from-orange-500 to-red-600', mult: 7 },
            { id: 'huntsman', name: 'Huntsman', price: 650, category: 'knives', color: 'from-amber-500 to-yellow-600', mult: 8 },
            { id: 'talon', name: 'Talon Knife', price: 1100, category: 'knives', color: 'from-red-500 to-pink-600', mult: 14 },
            { id: 'stiletto', name: 'Stiletto', price: 700, category: 'knives', color: 'from-purple-500 to-indigo-600', mult: 9 },
            { id: 'ursus', name: 'Ursus Knife', price: 750, category: 'knives', color: 'from-amber-600 to-orange-700', mult: 10 },
            { id: 'navaja', name: 'Navaja', price: 350, category: 'knives', color: 'from-gray-500 to-gray-700', mult: 4 },
            { id: 'skeleton', name: 'Skeleton', price: 1400, category: 'knives', color: 'from-gray-700 to-black', mult: 18 },
            { id: 'classic', name: 'Classic Knife', price: 900, category: 'knives', color: 'from-yellow-600 to-amber-700', mult: 12 },
            
            // ===== –ü–ï–†–ß–ê–¢–ö–ò (8 —à—Ç—É–∫) =====
            { id: 'sport', name: 'Sport Gloves', price: 600, category: 'gloves', color: 'from-blue-500 to-cyan-600', mult: 8 },
            { id: 'driver', name: 'Driver Gloves', price: 700, category: 'gloves', color: 'from-amber-500 to-yellow-600', mult: 9 },
            { id: 'handwraps', name: 'Hand Wraps', price: 500, category: 'gloves', color: 'from-red-500 to-orange-600', mult: 6 },
            { id: 'moto', name: 'Moto Gloves', price: 650, category: 'gloves', color: 'from-gray-600 to-gray-800', mult: 8 },
            { id: 'specialist', name: 'Specialist', price: 800, category: 'gloves', color: 'from-green-500 to-teal-600', mult: 10 },
            { id: 'hydra', name: 'Hydra Gloves', price: 900, category: 'gloves', color: 'from-purple-500 to-pink-600', mult: 12 },
            { id: 'bloodhound', name: 'Bloodhound', price: 550, category: 'gloves', color: 'from-red-600 to-red-800', mult: 7 },
            { id: 'brokenfang', name: 'Broken Fang', price: 1000, category: 'gloves', color: 'from-orange-500 to-red-600', mult: 13 },
            
            // ===== –ú–ï–ú–´ (12 —à—Ç—É–∫) =====
            { id: 'labubu', name: '–õ–∞–±—É–±—É', price: 777, category: 'memes', color: 'from-pink-400 to-rose-600', mult: 7.77 },
            { id: 'stonks', name: 'Stonks', price: 1337, category: 'memes', color: 'from-green-500 to-emerald-700', mult: 13.37 },
            { id: 'doge', name: 'Doge', price: 420, category: 'memes', color: 'from-yellow-400 to-amber-600', mult: 4.20 },
            { id: 'pepe', name: 'Pepe', price: 69, category: 'memes', color: 'from-green-400 to-green-600', mult: 0.69 },
            { id: 'amongus', name: 'Among Us', price: 228, category: 'memes', color: 'from-red-500 to-red-700', mult: 2.28 },
            { id: 'gigachad', name: 'GigaChad', price: 999, category: 'memes', color: 'from-gray-600 to-gray-800', mult: 9.99 },
            { id: 'shrek', name: 'Shrek', price: 322, category: 'memes', color: 'from-green-500 to-lime-600', mult: 3.22 },
            { id: 'rickroll', name: 'RickRoll', price: 1984, category: 'memes', color: 'from-orange-400 to-red-500', mult: 19.84 },
            { id: 'walter', name: 'Walter White', price: 500, category: 'memes', color: 'from-yellow-500 to-green-500', mult: 5 },
            { id: 'cheems', name: 'Cheems', price: 123, category: 'memes', color: 'from-yellow-400 to-amber-500', mult: 1.23 },
            { id: 'notstonks', name: 'Not Stonks', price: 13, category: 'memes', color: 'from-red-500 to-red-700', mult: 0.13 },
            { id: 'cryingcat', name: 'Crying Cat', price: 88, category: 'memes', color: 'from-gray-400 to-gray-600', mult: 0.88 },
            
            // ===== –û–°–û–ë–´–ï (10 —à—Ç—É–∫) =====
            { id: 'dragon', name: 'Dragon', price: 5000, category: 'special', color: 'from-red-600 to-orange-500', mult: 30 },
            { id: 'phoenix', name: 'Phoenix', price: 3000, category: 'special', color: 'from-orange-500 to-yellow-400', mult: 20 },
            { id: 'infinity', name: 'Infinity', price: 9999, category: 'special', color: 'from-violet-600 to-fuchsia-500', mult: 100 },
            { id: 'galaxy', name: 'Galaxy', price: 4000, category: 'special', color: 'from-purple-600 to-blue-500', mult: 25 },
            { id: 'rainbow', name: 'Rainbow', price: 2500, category: 'special', color: 'from-pink-500 via-yellow-500 to-cyan-500', mult: 15 },
            { id: 'unicorn', name: 'Unicorn', price: 3500, category: 'special', color: 'from-pink-400 to-purple-500', mult: 22 },
            { id: 'birthday', name: '–î–µ–Ω—å –†–æ–∂–¥–µ–Ω–∏—è', price: 1000, category: 'special', color: 'from-pink-500 to-yellow-400', mult: 10 },
            { id: 'newyear', name: '–ù–æ–≤—ã–π –ì–æ–¥', price: 2000, category: 'special', color: 'from-red-500 to-green-500', mult: 12 },
            { id: 'halloween', name: 'Halloween', price: 1500, category: 'special', color: 'from-orange-500 to-black', mult: 11 },
            { id: 'valentine', name: '–í–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞', price: 1400, category: 'special', color: 'from-pink-500 to-red-500', mult: 10 },
            
            // ===== ULTRA (10 —à—Ç—É–∫) =====
            { id: 'billionaire', name: 'Billionaire', price: 15000, category: 'ultra', color: 'from-yellow-400 to-yellow-600', mult: 150 },
            { id: 'trillionaire', name: 'Trillionaire', price: 25000, category: 'ultra', color: 'from-yellow-300 to-amber-500', mult: 250 },
            { id: 'dubai', name: 'Dubai VIP', price: 20000, category: 'ultra', color: 'from-yellow-500 to-amber-600', mult: 200 },
            { id: 'monaco', name: 'Monaco Casino', price: 30000, category: 'ultra', color: 'from-red-500 to-black', mult: 300 },
            { id: 'lamborghini', name: 'Lamborghini', price: 35000, category: 'ultra', color: 'from-yellow-400 to-orange-500', mult: 350 },
            { id: 'yacht', name: 'Mega Yacht', price: 40000, category: 'ultra', color: 'from-blue-400 to-cyan-500', mult: 400 },
            { id: 'mansion', name: 'Mansion', price: 45000, category: 'ultra', color: 'from-amber-500 to-yellow-600', mult: 450 },
            { id: 'spacex', name: 'SpaceX', price: 50000, category: 'ultra', color: 'from-gray-600 to-blue-600', mult: 500 },
            { id: 'privatejet', name: 'Private Jet', price: 38000, category: 'ultra', color: 'from-gray-500 to-blue-500', mult: 380 },
            { id: 'island', name: 'Private Island', price: 48000, category: 'ultra', color: 'from-green-400 to-cyan-500', mult: 480 },
            
            // ===== GOD TIER (12 —à—Ç—É–∫) =====
            { id: 'mars', name: 'Mars Colony', price: 75000, category: 'god', color: 'from-red-600 to-orange-600', mult: 750 },
            { id: 'blackhole', name: 'Black Hole', price: 100000, category: 'god', color: 'from-purple-900 to-black', mult: 1000 },
            { id: 'multiverse', name: 'Multiverse', price: 150000, category: 'god', color: 'from-violet-600 to-purple-600', mult: 1500 },
            { id: 'realitystone', name: 'Reality Stone', price: 200000, category: 'god', color: 'from-red-500 to-red-700', mult: 2000 },
            { id: 'timestone', name: 'Time Stone', price: 250000, category: 'god', color: 'from-green-500 to-emerald-600', mult: 2500 },
            { id: 'soulstone', name: 'Soul Stone', price: 300000, category: 'god', color: 'from-orange-500 to-amber-600', mult: 3000 },
            { id: 'mindstone', name: 'Mind Stone', price: 350000, category: 'god', color: 'from-yellow-400 to-yellow-600', mult: 3500 },
            { id: 'powerstone', name: 'Power Stone', price: 400000, category: 'god', color: 'from-purple-500 to-violet-600', mult: 4000 },
            { id: 'spacestone', name: 'Space Stone', price: 450000, category: 'god', color: 'from-blue-500 to-cyan-600', mult: 4500 },
            { id: 'thanos', name: 'Thanos Gauntlet', price: 500000, category: 'god', color: 'from-purple-600 to-pink-600', mult: 5000 },
            { id: 'godofgods', name: 'God of Gods', price: 750000, category: 'god', color: 'from-yellow-400 via-pink-500 to-purple-600', mult: 7500 },
            { id: 'creator', name: 'The Creator', price: 1000000, category: 'god', color: 'from-yellow-300 to-white', mult: 10000 },
            
            // ===== –ù–û–í–´–ï –ö–ï–ô–°–´ (15 —à—Ç—É–∫) =====
            // –ê–Ω–∏–º–µ
            { id: 'anime', name: 'Anime Waifu', price: 888, category: 'special', color: 'from-pink-400 to-purple-500', mult: 8.88 },
            { id: 'naruto', name: 'Naruto', price: 1111, category: 'special', color: 'from-orange-500 to-yellow-500', mult: 11.11 },
            
            // –ö—Ä–∏–ø—Ç–∞
            { id: 'bitcoin', name: 'Bitcoin', price: 21000, category: 'ultra', color: 'from-orange-500 to-yellow-600', mult: 210 },
            { id: 'ethereum', name: 'Ethereum', price: 15000, category: 'ultra', color: 'from-blue-400 to-purple-500', mult: 150 },
            { id: 'dogecoin', name: 'Dogecoin', price: 690, category: 'memes', color: 'from-yellow-400 to-amber-500', mult: 6.9 },
            
            // –ú—É–∑—ã–∫–∞
            { id: 'spotify', name: 'Spotify Premium', price: 300, category: 'special', color: 'from-green-500 to-green-700', mult: 3 },
            { id: 'travis', name: 'Travis Scott', price: 2222, category: 'special', color: 'from-brown-500 to-orange-600', mult: 22.22 },
            
            // –ï–¥–∞
            { id: 'mcdonalds', name: 'McDonalds', price: 150, category: 'basic', color: 'from-red-500 to-yellow-500', mult: 1.5 },
            { id: 'kfc', name: 'KFC Bucket', price: 250, category: 'basic', color: 'from-red-600 to-red-800', mult: 2.5 },
            
            // –ò–≥—Ä—ã
            { id: 'minecraft', name: 'Minecraft', price: 500, category: 'special', color: 'from-green-600 to-brown-600', mult: 5 },
            { id: 'fortnite', name: 'Fortnite', price: 750, category: 'special', color: 'from-blue-500 to-purple-600', mult: 7.5 },
            { id: 'gta6', name: 'GTA 6', price: 6666, category: 'ultra', color: 'from-orange-600 to-green-600', mult: 66.66 },
            
            // –†–æ—Å–∫–æ—à—å
            { id: 'rolex', name: 'Rolex', price: 55000, category: 'ultra', color: 'from-yellow-500 to-green-600', mult: 550 },
            { id: 'bugatti', name: 'Bugatti', price: 85000, category: 'god', color: 'from-blue-600 to-black', mult: 850 },
            
            // –ö–æ—Å–º–æ—Å
            { id: 'moonbase', name: 'Moon Base', price: 65000, category: 'god', color: 'from-gray-400 to-gray-600', mult: 650 },
        ];

        const allItems = [
            // Trash
            { name: 'P250 | Sand Dune', icon: 'üî´', rarity: 'trash', baseValue: 0.05 },
            { name: '–§–æ—Ç–æ –∫–∞—Ä—Ç–æ—à–∫–∏', icon: 'ü•î', rarity: 'trash', baseValue: 0.01 },
            { name: '–°–∫—Ä–µ–ø–∫–∞', icon: 'üìé', rarity: 'trash', baseValue: 0.02 },
            { name: '–ü—É—Å—Ç–æ–π —Ñ–∞–Ω—Ç–∏–∫', icon: 'üç¨', rarity: 'trash', baseValue: 0.01 },
            { name: '1 —Ä—É–±–ª—å', icon: 'üí∞', rarity: 'trash', baseValue: 0.01 },
            // Common
            { name: 'AK-47 | Elite Build', icon: 'üî´', rarity: 'common', baseValue: 2.50 },
            { name: '–ë–∞–Ω–∫–∞ –≥–∞–∑–∏—Ä–æ–≤–∫–∏', icon: 'ü•§', rarity: 'common', baseValue: 1.50 },
            { name: '–®–æ–∫–æ–ª–∞–¥–∫–∞', icon: 'üç´', rarity: 'common', baseValue: 1.00 },
            { name: '–ö–ª—é—á –æ—Ç –∫–µ–π—Å–∞', icon: 'üîë', rarity: 'common', baseValue: 2.50 },
            // Uncommon
            { name: 'AK-47 | Redline', icon: 'üî´', rarity: 'uncommon', baseValue: 12.00 },
            { name: 'AWP | Asiimov', icon: 'üî´', rarity: 'uncommon', baseValue: 15.00 },
            { name: '–ü–∏—Ü—Ü–∞ –Ω–∞ –¥–æ–º', icon: 'üçï', rarity: 'uncommon', baseValue: 8.00 },
            // Rare
            { name: 'Desert Eagle | Printstream', icon: 'üî´', rarity: 'rare', baseValue: 35.00 },
            { name: 'Discord Nitro', icon: 'üíú', rarity: 'rare', baseValue: 10.00 },
            { name: 'AWP | Hyper Beast', icon: 'üî´', rarity: 'rare', baseValue: 45.00 },
            // Epic
            { name: 'Steam –∫–∞—Ä—Ç–∞ $50', icon: 'üí≥', rarity: 'epic', baseValue: 50.00 },
            { name: 'AK-47 | Vulcan', icon: 'üî´', rarity: 'epic', baseValue: 120.00 },
            // Legendary
            { name: 'Karambit | Fade', icon: 'üî™', rarity: 'legendary', baseValue: 400.00 },
            { name: 'AWP | Dragon Lore', icon: 'üêâ', rarity: 'legendary', baseValue: 500.00 },
            { name: 'M4A4 | Howl', icon: 'üê∫', rarity: 'legendary', baseValue: 450.00 },
            // Mythical
            { name: 'AK-47 | Gold Arabesque', icon: 'üî´', rarity: 'mythical', baseValue: 600.00 },
            { name: 'AWP | Desert Hydra', icon: 'üêç', rarity: 'mythical', baseValue: 1200.00 },
            // Special
            { name: '–ö–∞—Ä—Ç–∞ –†–µ–≤–µ—Ä—Å', icon: 'üîÑ', rarity: 'special', baseValue: 50.00 },
            { name: '–ú–Ω–æ–∂–∏—Ç–µ–ª—å x2', icon: '‚úñÔ∏è', rarity: 'special', baseValue: 100.00 },
            { name: '–î–∂–æ–∫–µ—Ä', icon: 'üÉè', rarity: 'special', baseValue: 200.00 },
            // Meme
            { name: '–£–≤–∞–∂–µ–Ω–∏–µ –ø–∞—Ü–∞–Ω–æ–≤', icon: 'ü§ú', rarity: 'meme', baseValue: 999.99 },
            { name: '100 –æ—Ç–∂–∏–º–∞–Ω–∏–π', icon: 'üí™', rarity: 'meme', baseValue: 0 },
            // God Tier
            { name: 'Gabe Newell', icon: 'üßî', rarity: 'godtier', baseValue: 99999.00 },
            { name: '–ê–¥–º–∏–Ω–∫–∞ –Ω–∞ 24—á', icon: 'üëë', rarity: 'godtier', baseValue: 5000.00 },
        ];

        function getRarityWeights(price) {
            if (price <= 20) return { trash: 60, common: 30, uncommon: 7, rare: 2, epic: 0.5, legendary: 0.1, mythical: 0.01, special: 0.5, meme: 3, godtier: 0.001 };
            if (price <= 100) return { trash: 40, common: 35, uncommon: 15, rare: 6, epic: 2, legendary: 0.5, mythical: 0.1, special: 1, meme: 2, godtier: 0.01 };
            if (price <= 500) return { trash: 20, common: 30, uncommon: 25, rare: 15, epic: 6, legendary: 2, mythical: 0.5, special: 1.5, meme: 1, godtier: 0.05 };
            if (price <= 2000) return { trash: 10, common: 20, uncommon: 25, rare: 25, epic: 12, legendary: 5, mythical: 1.5, special: 2, meme: 0.5, godtier: 0.1 };
            return { trash: 5, common: 10, uncommon: 20, rare: 25, epic: 20, legendary: 12, mythical: 5, special: 2, meme: 0.5, godtier: 0.5 };
        }

        // ==================== GAME STATE ====================
        let currentUser = null;
        let isSpinning = false;
        let selectedCase = allCases[2];
        let selectedCategory = 'all';
        let currentRound = 1;
        let totalRounds = 5;
        let player1Total = 0, player2Total = 0;
        let player1Items = [], player2Items = [];
        let selectedInventoryItems = [];
        let isAdmin = false;
        let luckMult = 1;
        let soundEnabled = true;
        let confettiEnabled = true;
        let sendMoneyTarget = null;

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

        function playSound(type) {
            if (!soundEnabled) return;
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            gain.gain.value = 0.1;
            if (type === 'tick') { osc.frequency.value = 600 + Math.random() * 400; osc.start(); osc.stop(audioCtx.currentTime + 0.02); }
            else if (type === 'win') { osc.frequency.value = 800; osc.start(); osc.stop(audioCtx.currentTime + 0.2); }
        }

        // ==================== AUTH ====================
        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach((t, i) => t.classList.toggle('active', (i === 0 && tab === 'login') || (i === 1 && tab === 'register')));
            document.getElementById('loginForm').style.display = tab === 'login' ? 'block' : 'none';
            document.getElementById('registerForm').style.display = tab === 'register' ? 'block' : 'none';
            document.getElementById('authError').textContent = '';
        }

        function login() {
            const username = document.getElementById('loginUsername').value.trim();
            const password = document.getElementById('loginPassword').value;
            
            if (!username || !password) {
                document.getElementById('authError').textContent = '–ó–∞–ø–æ–ª–Ω–∏ –≤—Å–µ –ø–æ–ª—è!';
                return;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const users = DB.getUsers();
            console.log('All users:', users);
            console.log('Trying to login:', username, password);
            
            // –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–±–µ–∑ —É—á—ë—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞)
            let foundUser = null;
            let foundKey = null;
            
            for (const key of Object.keys(users)) {
                if (key.toLowerCase() === username.toLowerCase()) {
                    foundKey = key;
                    foundUser = users[key];
                    break;
                }
            }
            
            console.log('Found user:', foundUser);
            
            if (!foundUser) {
                document.getElementById('authError').textContent = '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!';
                return;
            }
            
            if (foundUser.password !== password) {
                document.getElementById('authError').textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å!';
                return;
            }
            
            foundUser.lastOnline = Date.now();
            DB.saveUser(foundKey, foundUser);
            DB.setCurrentUser(foundKey);
            currentUser = foundUser;
            showGame();
        }

        function register() {
            const username = document.getElementById('regUsername').value.trim();
            const email = document.getElementById('regEmail').value.trim();
            const password = document.getElementById('regPassword').value;
            const password2 = document.getElementById('regPassword2').value;
            
            if (!username || !password) {
                document.getElementById('authError').textContent = '–ó–∞–ø–æ–ª–Ω–∏ –Ω–∏–∫–Ω–µ–π–º –∏ –ø–∞—Ä–æ–ª—å!';
                return;
            }
            
            if (username.length < 3) {
                document.getElementById('authError').textContent = '–ù–∏–∫–Ω–µ–π–º –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞!';
                return;
            }
            
            if (password.length < 4) {
                document.getElementById('authError').textContent = '–ü–∞—Ä–æ–ª—å –º–∏–Ω–∏–º—É–º 4 —Å–∏–º–≤–æ–ª–∞!';
                return;
            }
            
            if (password !== password2) {
                document.getElementById('authError').textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç!';
                return;
            }
            
            if (!DB.createUser(username, password, email)) {
                document.getElementById('authError').textContent = '–≠—Ç–æ—Ç –Ω–∏–∫–Ω–µ–π–º —É–∂–µ –∑–∞–Ω—è—Ç!';
                return;
            }
            
            DB.setCurrentUser(username);
            currentUser = DB.getUser(username);
            showGame();
            showNotification('üéâ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ' + username + '!', 'success');
        }

        function logout() {
            DB.clearCurrentUser();
            currentUser = null;
            isAdmin = false;
            document.getElementById('adminBtn').classList.remove('visible');
            hideGame();
        }

        function showGame() {
            document.getElementById('authScreen').classList.add('hidden');
            document.getElementById('topHeader').classList.remove('hidden');
            document.getElementById('mainContent').style.display = 'block';
            document.getElementById('mainFooter').style.display = 'block';
            document.body.classList.add('logged-in');
            updateUI();
            renderCategories();
            renderCases();
            initRoulette();
        }

        function hideGame() {
            document.getElementById('authScreen').classList.remove('hidden');
            document.getElementById('topHeader').classList.add('hidden');
            document.getElementById('mainContent').style.display = 'none';
            document.getElementById('mainFooter').style.display = 'none';
            document.body.classList.remove('logged-in');
        }

        // ==================== LEVEL SYSTEM ====================
        function getXpForLevel(level) {
            // –§–æ—Ä–º—É–ª–∞: –∫–∞–∂–¥—ã–π —É—Ä–æ–≤–µ–Ω—å —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ XP
            return Math.floor(100 * Math.pow(1.5, level - 1));
        }
        
        function addXP(amount) {
            if (!currentUser) return;
            
            currentUser.xp = (currentUser.xp || 0) + amount;
            const requiredXP = getXpForLevel(currentUser.level);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
            while (currentUser.xp >= requiredXP) {
                currentUser.xp -= requiredXP;
                currentUser.level++;
                
                // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ —É—Ä–æ–≤–µ–Ω—å
                const reward = currentUser.level * 100;
                currentUser.balance += reward;
                
                showNotification(`üéâ LEVEL UP! –£—Ä–æ–≤–µ–Ω—å ${currentUser.level}! +${formatMoney(reward)}`, 'success');
                if (confettiEnabled) createConfetti();
                playSound('win');
            }
            
            saveUser();
            updateUI();
        }
        
        function getXpForAction(action, value = 0) {
            switch(action) {
                case 'open_case': return 10 + Math.floor(value / 10); // 10 XP + –±–æ–Ω—É—Å –æ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏
                case 'win_battle': return 50 + Math.floor(value / 5); // 50 XP + –±–æ–Ω—É—Å –æ—Ç –≤—ã–∏–≥—Ä—ã—à–∞
                case 'lose_battle': return 15; // –£—Ç–µ—à–∏—Ç–µ–ª—å–Ω—ã–π XP
                case 'sell_item': return 5 + Math.floor(value / 20); // XP –∑–∞ –ø—Ä–æ–¥–∞–∂—É
                case 'rare_drop': return 100; // –ë–æ–Ω—É—Å –∑–∞ —Ä–µ–¥–∫–∏–π –¥—Ä–æ–ø
                case 'legendary_drop': return 250; // –ë–æ–Ω—É—Å –∑–∞ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π
                case 'mythical_drop': return 500; // –ë–æ–Ω—É—Å –∑–∞ –º–∏—Ñ–∏—á–µ—Å–∫–∏–π
                case 'godtier_drop': return 1000; // –û–≥—Ä–æ–º–Ω—ã–π –±–æ–Ω—É—Å –∑–∞ God Tier
                default: return 5;
            }
        }

        // ==================== UI ====================
        function formatMoney(amt) {
            return '$' + amt.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
        }

        function updateUI() {
            if (!currentUser) return;
            document.getElementById('userName').textContent = currentUser.username;
            document.getElementById('userLevel').textContent = currentUser.level;
            document.getElementById('userAvatar').textContent = currentUser.avatar;
            document.getElementById('headerBalance').textContent = formatMoney(currentUser.balance);
            document.getElementById('headerWins').textContent = currentUser.wins;
            document.getElementById('headerStreak').textContent = 'üî• ' + currentUser.streak;
            document.getElementById('inventoryBadge').textContent = currentUser.inventory.length;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º XP –ø—Ä–æ–≥—Ä–µ—Å—Å
            const xpNeeded = getXpForLevel(currentUser.level);
            const xpCurrent = currentUser.xp || 0;
            const xpPercent = Math.min(100, (xpCurrent / xpNeeded) * 100);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º XP –±–∞—Ä
            const xpBar = document.getElementById('userXpBar');
            const xpText = document.getElementById('userXpText');
            if (xpBar) xpBar.style.width = xpPercent + '%';
            if (xpText) xpText.textContent = `(${xpCurrent}/${xpNeeded} XP)`;
            
            // Update friend requests badge
            if (currentUser.friendRequests && currentUser.friendRequests.length > 0) {
                document.getElementById('friendsBadge').style.display = 'block';
                document.getElementById('friendsBadge').textContent = currentUser.friendRequests.length;
            } else {
                document.getElementById('friendsBadge').style.display = 'none';
            }
        }

        function saveUser() {
            if (currentUser) {
                DB.saveUser(currentUser.username, currentUser);
            }
        }

        function showNotification(text, type = 'info') {
            document.getElementById('notificationText').textContent = text;
            document.getElementById('notificationContent').className = 'notification-content notification-' + type;
            document.getElementById('notificationBanner').classList.add('show');
            setTimeout(() => document.getElementById('notificationBanner').classList.remove('show'), 3000);
        }

        // ==================== CATEGORIES & CASES ====================
        function renderCategories() {
            document.getElementById('categoryTabs').innerHTML = Object.entries(categories).map(([k, v]) =>
                `<button class="category-tab ${selectedCategory === k ? 'active' : ''}" onclick="selectCategory('${k}')">${v}</button>`
            ).join('');
        }

        function renderCases() {
            let filtered = selectedCategory === 'all' ? [...allCases] : allCases.filter(c => c.category === selectedCategory);
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Ü–µ–Ω–µ
            filtered.sort((a, b) => a.price - b.price);
            document.getElementById('casesGrid').innerHTML = filtered.map(c => {
                const emoji = getFallbackEmoji(c.id, c.category);
                return `
                <div class="case-card ${selectedCase.id === c.id ? 'selected' : ''}" onclick="selectCase('${c.id}')">
                    <div class="case-image bg-gradient-to-br ${c.color}">
                        <div class="case-image-fallback">${emoji}</div>
                    </div>
                    <h3 class="font-bold text-sm text-center truncate">${c.name}</h3>
                    <div class="font-orbitron text-lg text-green-400 text-center">${formatMoney(c.price)}</div>
                </div>
            `}).join('');
        }
        
        function getFallbackEmoji(id, category) {
            const specificEmojis = {
                // –ë–∞–∑–æ–≤—ã–µ
                bomzh: 'üóëÔ∏è', budget: 'üíµ', standard: 'üì¶', premium: 'üíé', legendary: 'üëë', major: 'ü§ë', godlike: '‚ö°',
                // –ó–≤–∞–Ω–∏—è CS
                silver1: 'ü•â', silver2: 'ü•â', silver3: 'ü•â', silver4: 'ü•â', 
                silverelite: 'ü•à', silverelitemaster: 'ü•à',
                gold1: 'ü•á', gold2: 'ü•á', gold3: 'ü•á', goldmaster: 'üèÖ',
                mg1: '‚≠ê', mg2: '‚≠ê', mge: 'üåü', dmg: 'üí´',
                le: 'ü¶Ö', lem: 'ü¶Ö', supreme: 'üëë', global: 'üåç',
                // –û—Ä—É–∂–∏–µ
                ak47: 'üî´', awp: 'üéØ', m4a4: 'üî´', m4a1s: 'üî´', deagle: 'ü¶Ö', usps: 'üî´', glock: 'üî´',
                famas: 'üî´', galil: 'üî´', aug: 'üî´', sg553: 'üî´', ssg08: 'üéØ', scar20: 'üî´', g3sg1: 'üî´',
                mp9: 'üî´', mac10: 'üî´', p90: 'üî´', ump45: 'üî´', mp7: 'üî´', bizon: 'üî´',
                nova: 'üí•', xm1014: 'üí•', mag7: 'üí•', negev: 'üí•',
                p250: 'üî´', tec9: 'üî´', fiveseven: 'üî´', cz75: 'üî´', r8: 'ü§†',
                // –ù–æ–∂–∏
                karambit: 'ü¶Ç', butterfly: 'ü¶ã', m9bayonet: 'üî™', bayonet: 'üó°Ô∏è',
                flip: 'üî™', gut: 'üî™', falchion: '‚öîÔ∏è', bowie: 'üó°Ô∏è', huntsman: 'üèπ',
                talon: 'ü¶Ö', stiletto: 'üó°Ô∏è', ursus: 'üêª', navaja: 'üî™',
                paracord: 'ü™¢', survival: 'üèïÔ∏è', nomad: 'üèúÔ∏è', skeleton: 'üíÄ', classic: 'üî™',
                // –ü–µ—Ä—á–∞—Ç–∫–∏
                sport: 'üß§', driver: 'üß§', handwraps: 'ü•ä', moto: 'üèçÔ∏è',
                specialist: 'üéñÔ∏è', hydra: 'üêç', bloodhound: 'üêï', brokenfang: 'ü¶∑',
                // –ú–µ–º—ã
                labubu: 'üß∏', stonks: 'üìà', doge: 'üêï', pepe: 'üê∏', amongus: 'üìÆ', 
                gigachad: 'üí™', shrek: 'üßÖ', rickroll: 'üéµ', walter: 'üß™',
                cheems: 'üêï', notstonks: 'üìâ', cryingcat: 'üòø',
                // –û—Å–æ–±—ã–µ
                dragon: 'üêâ', phoenix: 'üî•', infinity: '‚ôæÔ∏è', galaxy: 'üåå', rainbow: 'üåà', unicorn: 'ü¶Ñ',
                birthday: 'üéÇ', newyear: 'üéÑ', halloween: 'üéÉ', valentine: 'üíù',
                summer: '‚òÄÔ∏è', winter: '‚ùÑÔ∏è', esports: 'üéÆ', operation: 'üéñÔ∏è',
                // Ultra
                billionaire: 'üí∞', trillionaire: 'üíé', dubai: 'üèôÔ∏è', monaco: 'üé∞', 
                lamborghini: 'üèéÔ∏è', yacht: 'üõ•Ô∏è', mansion: 'üè∞', spacex: 'üöÄ', 
                privatejet: '‚úàÔ∏è', island: 'üèùÔ∏è',
                // God Tier
                mars: 'üî¥', blackhole: 'üï≥Ô∏è', multiverse: 'üåÄ', 
                realitystone: '‚ù§Ô∏è', timestone: 'üíö', soulstone: 'üß°', 
                mindstone: 'üíõ', powerstone: 'üíú', spacestone: 'üíô',
                thanos: 'üü£', godofgods: '‚ö°', creator: '‚ú®',
                // –ù–æ–≤—ã–µ –∫–µ–π—Å—ã
                anime: 'üéÄ', naruto: 'üç•', bitcoin: '‚Çø', ethereum: 'üíé', dogecoin: 'üê∂',
                spotify: 'üéµ', travis: 'üé§', mcdonalds: 'üçî', kfc: 'üçó',
                minecraft: '‚õèÔ∏è', fortnite: 'üéÆ', gta6: 'üöó', rolex: '‚åö', bugatti: 'üèéÔ∏è', moonbase: 'üåô'
            };
            const categoryEmojis = {
                basic: 'üì¶', premium: 'üíé', ranks: 'üéñÔ∏è', weapons: 'üî´',
                knives: 'üî™', gloves: 'üß§', memes: 'üòÇ', special: '‚ú®',
                ultra: 'üëë', god: '‚ö°'
            };
            return specificEmojis[id] || categoryEmojis[category] || 'üì¶';
        }

        function selectCategory(cat) { selectedCategory = cat; renderCategories(); renderCases(); }
        function selectCase(id) { if (isSpinning) return; selectedCase = allCases.find(c => c.id === id); renderCases(); document.getElementById('casePriceText').textContent = formatMoney(selectedCase.price); initRoulette(); }

        // ==================== ROULETTE ====================
        function getRandomItem(price) {
            const weights = getRarityWeights(price);
            Object.keys(weights).forEach(k => {
                if (['legendary', 'mythical', 'godtier', 'epic'].includes(k)) weights[k] *= luckMult;
            });
            const total = Object.values(weights).reduce((a, b) => a + b, 0);
            let rand = Math.random() * total;
            for (const [rarity, weight] of Object.entries(weights)) {
                rand -= weight;
                if (rand <= 0) {
                    const items = allItems.filter(i => i.rarity === rarity);
                    return items.length ? items[Math.floor(Math.random() * items.length)] : allItems[0];
                }
            }
            return allItems[0];
        }

        function generateItems(count = 60) { return Array.from({ length: count }, () => getRandomItem(selectedCase.price)); }

        function createRouletteHTML(items) {
            return items.map(item => {
                const value = Math.max(0.01, item.baseValue * selectedCase.mult);
                return `<div class="roulette-item rarity-${item.rarity}">
                    <span class="text-2xl">${item.icon}</span>
                    <span class="text-[10px] font-bold truncate w-full text-center px-1">${item.name.split(' | ')[0]}</span>
                    <span class="text-xs text-green-400">${formatMoney(value)}</span>
                </div>`;
            }).join('');
        }

        function initRoulette() {
            const items = generateItems();
            const el = document.getElementById('soloRoulette');
            el.innerHTML = createRouletteHTML(items);
            el.style.transition = 'none';
            el.style.transform = 'translateX(0)';
            document.getElementById('wonItemDisplay').classList.add('hidden');
            return items;
        }

        function initBattleRoulettes() {
            const items1 = generateItems(), items2 = generateItems();
            ['roulette1', 'roulette2'].forEach((id, i) => {
                const el = document.getElementById(id);
                el.innerHTML = createRouletteHTML(i === 0 ? items1 : items2);
                el.style.transition = 'none';
                el.style.transform = 'translateX(0)';
            });
            return { items1, items2 };
        }

        // ==================== CASE OPENING ====================
        async function openCase() {
            if (!currentUser || isSpinning || currentUser.balance < selectedCase.price) {
                if (currentUser && currentUser.balance < selectedCase.price) showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', 'error');
                return;
            }
            isSpinning = true;
            currentUser.balance -= selectedCase.price;
            currentUser.casesOpened++;
            updateUI();
            saveUser();
            document.getElementById('openCaseBtn').disabled = true;
            document.getElementById('wonItemDisplay').classList.add('hidden');

            const fastMode = document.getElementById('fastModeCheck').checked;
            const items = initRoulette();
            const roulette = document.getElementById('soloRoulette');
            const winIndex = 40 + Math.floor(Math.random() * 15);
            const wonItem = items[winIndex];
            const value = Math.max(0.01, wonItem.baseValue * selectedCase.mult);

            const speed = fastMode ? 0.5 : parseFloat(document.getElementById('speedSelect').value);
            const itemWidth = 128;
            const containerWidth = roulette.parentElement.offsetWidth;
            const offset = -(winIndex * itemWidth - containerWidth / 2 + 60);

            if (!fastMode) roulette.classList.add('spinning');

            const tickInterval = !fastMode ? setInterval(() => playSound('tick'), 80) : null;
            if (tickInterval) setTimeout(() => clearInterval(tickInterval), speed * 800);

            setTimeout(() => {
                roulette.style.transition = `transform ${speed}s cubic-bezier(0.1, 0.7, 0.3, 1)`;
                roulette.style.transform = `translateX(${offset}px)`;
                roulette.classList.remove('spinning');
            }, 50);

            await new Promise(r => setTimeout(r, speed * 1000 + 200));

            const card = document.getElementById('wonItemCard');
            card.className = `inline-block p-6 rounded-2xl border-2 rarity-${wonItem.rarity}`;
            document.getElementById('wonItemIcon').textContent = wonItem.icon;
            document.getElementById('wonItemName').textContent = wonItem.name;
            document.getElementById('wonItemValue').textContent = formatMoney(value);
            document.getElementById('wonItemDisplay').classList.remove('hidden');

            currentUser.inventory.push({ ...wonItem, value, id: Date.now() });
            saveUser();

            // –î–æ–±–∞–≤–ª—è–µ–º –≤ Live Feed –≤—Å–µ –¥—Ä–æ–ø—ã (–Ω–µ —Ç–æ–ª—å–∫–æ —Ä–µ–¥–∫–∏–µ)
            addLiveFeed(currentUser.username, wonItem, value);

            // –ù–∞—á–∏—Å–ª—è–µ–º XP –∑–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫–µ–π—Å–∞
            let xpGained = getXpForAction('open_case', selectedCase.price);
            
            // –ë–æ–Ω—É—Å–Ω—ã–π XP –∑–∞ —Ä–µ–¥–∫–∏–µ –¥—Ä–æ–ø—ã
            if (wonItem.rarity === 'rare' || wonItem.rarity === 'epic') {
                xpGained += getXpForAction('rare_drop');
            } else if (wonItem.rarity === 'legendary') {
                xpGained += getXpForAction('legendary_drop');
            } else if (wonItem.rarity === 'mythical') {
                xpGained += getXpForAction('mythical_drop');
            } else if (wonItem.rarity === 'godtier') {
                xpGained += getXpForAction('godtier_drop');
            }
            
            addXP(xpGained);

            if (['legendary', 'mythical', 'godtier'].includes(wonItem.rarity)) {
                if (confettiEnabled) createConfetti();
                playSound('win');
            }

            isSpinning = false;
            document.getElementById('openCaseBtn').disabled = false;
            updateUI();
        }

        // ==================== BATTLE ====================
        async function startBattle() {
            if (!currentUser || isSpinning || currentUser.balance < selectedCase.price) return;
            isSpinning = true;
            currentUser.balance -= selectedCase.price;
            updateUI();
            saveUser();
            document.getElementById('battleBtn').disabled = true;

            const { items1, items2 } = initBattleRoulettes();
            const winIndex1 = 40 + Math.floor(Math.random() * 15);
            const winIndex2 = 40 + Math.floor(Math.random() * 15);
            const won1 = items1[winIndex1], won2 = items2[winIndex2];
            const val1 = Math.max(0.01, won1.baseValue * selectedCase.mult);
            const val2 = Math.max(0.01, won2.baseValue * selectedCase.mult);

            const speed = parseFloat(document.getElementById('speedSelect').value);

            ['roulette1', 'roulette2'].forEach((id, i) => {
                const el = document.getElementById(id);
                const idx = i === 0 ? winIndex1 : winIndex2;
                const offset = -(idx * 128 - el.parentElement.offsetWidth / 2 + 60);
                setTimeout(() => {
                    el.style.transition = `transform ${speed}s cubic-bezier(0.1, 0.7, 0.3, 1)`;
                    el.style.transform = `translateX(${offset}px)`;
                }, 50);
            });

            const tickInterval = setInterval(() => playSound('tick'), 100);
            setTimeout(() => clearInterval(tickInterval), speed * 800);

            await new Promise(r => setTimeout(r, speed * 1000 + 300));

            player1Total += val1;
            player2Total += val2;
            player1Items.push({ ...won1, value: val1 });
            player2Items.push({ ...won2, value: val2 });

            [1, 2].forEach(p => {
                const item = p === 1 ? won1 : won2;
                const container = document.getElementById(`player${p}Items`);
                const el = document.createElement('div');
                el.className = `roulette-item rarity-${item.rarity}`;
                el.style.cssText = 'width:45px;height:45px;font-size:10px';
                el.innerHTML = `<span class="text-lg">${item.icon}</span>`;
                container.appendChild(el);
            });

            document.getElementById('player1Score').textContent = formatMoney(player1Total);
            document.getElementById('player2Score').textContent = formatMoney(player2Total);
            document.getElementById('currentRound').textContent = currentRound;

            currentRound++;

            if (currentRound > totalRounds) {
                setTimeout(showBattleResult, 500);
            } else {
                isSpinning = false;
                document.getElementById('battleBtn').disabled = false;
                setTimeout(initBattleRoulettes, 500);
            }
        }

        function showBattleResult() {
            const playerWon = player1Total > player2Total;
            if (playerWon) {
                [...player1Items, ...player2Items].forEach(i => currentUser.inventory.push({ ...i, id: Date.now() + Math.random() }));
                currentUser.wins++;
                currentUser.streak++;
                saveUser();
                
                // XP –∑–∞ –ø–æ–±–µ–¥—É
                const xpGained = getXpForAction('win_battle', player1Total + player2Total);
                addXP(xpGained);
                
                if (confettiEnabled) createConfetti();
                showNotification(`üèÜ –ü–û–ë–ï–î–ê! +${formatMoney(player1Total + player2Total)} (+${xpGained} XP)`, 'success');
            } else {
                currentUser.streak = 0;
                saveUser();
                
                // –£—Ç–µ—à–∏—Ç–µ–ª—å–Ω—ã–π XP –∑–∞ –ø–æ—Ä–∞–∂–µ–Ω–∏–µ
                const xpGained = getXpForAction('lose_battle');
                addXP(xpGained);
                
                showNotification(`üíÄ –ü–æ—Ä–∞–∂–µ–Ω–∏–µ... (+${xpGained} XP)`, 'error');
            }
            updateUI();
        }

        function resetBattle() {
            currentRound = 1;
            player1Total = 0;
            player2Total = 0;
            player1Items = [];
            player2Items = [];
            isSpinning = false;
            document.getElementById('player1Items').innerHTML = '';
            document.getElementById('player2Items').innerHTML = '';
            document.getElementById('player1Score').textContent = '$0.00';
            document.getElementById('player2Score').textContent = '$0.00';
            document.getElementById('currentRound').textContent = '1';
            document.getElementById('battleBtn').disabled = false;
            initBattleRoulettes();
        }

        // ==================== INVENTORY ====================
        function openInventory() { 
            document.getElementById('inventoryModal').classList.add('open'); 
            selectedInventoryItems = [];
            renderInventory(); 
        }
        function closeInventory(e) { if (!e || e.target === e.currentTarget) document.getElementById('inventoryModal').classList.remove('open'); }

        function renderInventory() {
            const grid = document.getElementById('inventoryGrid');
            if (!currentUser || currentUser.inventory.length === 0) {
                grid.innerHTML = '<div class="col-span-full text-center text-gray-500 py-10">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>';
            } else {
                grid.innerHTML = currentUser.inventory.map((item, i) => `
                    <div class="inventory-item rarity-${item.rarity} ${selectedInventoryItems.includes(i) ? 'selected' : ''}" 
                         onclick="toggleInventoryItem(${i})" title="${item.name}\n${formatMoney(item.value)}">
                        <span class="text-xl">${item.icon}</span>
                        <span class="text-[9px]">${formatMoney(item.value)}</span>
                    </div>
                `).join('');
            }
            document.getElementById('invCount').textContent = currentUser ? currentUser.inventory.length : 0;
            document.getElementById('invValue').textContent = formatMoney(currentUser ? currentUser.inventory.reduce((s, i) => s + i.value, 0) : 0);
        }

        function toggleInventoryItem(idx) {
            const i = selectedInventoryItems.indexOf(idx);
            if (i === -1) selectedInventoryItems.push(idx);
            else selectedInventoryItems.splice(i, 1);
            renderInventory();
        }

        function sellSelected() {
            if (selectedInventoryItems.length === 0) return;
            let total = 0;
            selectedInventoryItems.sort((a, b) => b - a).forEach(idx => {
                total += currentUser.inventory[idx].value;
                currentUser.inventory.splice(idx, 1);
            });
            currentUser.balance += total;
            selectedInventoryItems = [];
            
            // XP –∑–∞ –ø—Ä–æ–¥–∞–∂—É
            const xpGained = getXpForAction('sell_item', total);
            addXP(xpGained);
            
            saveUser();
            updateUI();
            renderInventory();
            showNotification(`üí∞ –ü—Ä–æ–¥–∞–Ω–æ –∑–∞ ${formatMoney(total)} (+${xpGained} XP)`, 'success');
        }

        function sellAll() {
            if (!currentUser || currentUser.inventory.length === 0) return;
            const total = currentUser.inventory.reduce((s, i) => s + i.value, 0);
            currentUser.balance += total;
            currentUser.inventory = [];
            
            // XP –∑–∞ –ø—Ä–æ–¥–∞–∂—É –≤—Å–µ–≥–æ
            const xpGained = getXpForAction('sell_item', total);
            addXP(xpGained);
            
            saveUser();
            updateUI();
            renderInventory();
            if (confettiEnabled) createConfetti();
            showNotification(`üí∞ –ü—Ä–æ–¥–∞–Ω–æ –≤—Å—ë –∑–∞ ${formatMoney(total)} (+${xpGained} XP)`, 'success');
        }

        // ==================== FRIENDS ====================
        function openFriends() { 
            document.getElementById('friendsModal').classList.add('open'); 
            renderFriends(); 
        }
        function closeFriends(e) { if (!e || e.target === e.currentTarget) document.getElementById('friendsModal').classList.remove('open'); }

        function renderFriends() {
            if (!currentUser) return;
            
            // Friend requests
            const requestsContainer = document.getElementById('friendRequests');
            const requestsList = document.getElementById('friendRequestsList');
            if (currentUser.friendRequests && currentUser.friendRequests.length > 0) {
                requestsContainer.classList.remove('hidden');
                requestsList.innerHTML = currentUser.friendRequests.map(username => `
                    <div class="friend-card">
                        <div class="friend-avatar">üë§</div>
                        <div class="flex-1">
                            <div class="font-bold">${username}</div>
                            <div class="text-xs text-gray-400">–•–æ—á–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å —Ç–µ–±—è</div>
                        </div>
                        <button onclick="acceptFriend('${username}')" class="px-3 py-1 bg-green-600 rounded-lg text-sm">‚úì</button>
                        <button onclick="declineFriend('${username}')" class="px-3 py-1 bg-red-600 rounded-lg text-sm">‚úï</button>
                    </div>
                `).join('');
            } else {
                requestsContainer.classList.add('hidden');
            }
            
            // Friends list
            const friendsList = document.getElementById('friendsList');
            if (currentUser.friends && currentUser.friends.length > 0) {
                friendsList.innerHTML = currentUser.friends.map(username => {
                    const friend = DB.getUser(username);
                    const isOnline = friend && (Date.now() - friend.lastOnline < 300000);
                    return `
                        <div class="friend-card">
                            <div class="relative">
                                <div class="friend-avatar">${friend ? friend.avatar : 'üë§'}</div>
                                <div class="friend-status ${isOnline ? 'online' : 'offline'}"></div>
                            </div>
                            <div class="flex-1">
                                <div class="font-bold">${username}</div>
                                <div class="text-xs text-gray-400">Lv. ${friend ? friend.level : 1} ‚Ä¢ ${isOnline ? 'üü¢ –û–Ω–ª–∞–π–Ω' : 'üî¥ –û—Ñ—Ñ–ª–∞–π–Ω'}</div>
                            </div>
                            <button onclick="openSendMoneyTo('${username}')" class="px-3 py-1 bg-green-600 rounded-lg text-sm">üí∏</button>
                            <button onclick="removeFriend('${username}')" class="px-3 py-1 bg-red-600 rounded-lg text-sm">‚úï</button>
                        </div>
                    `;
                }).join('');
            } else {
                friendsList.innerHTML = '<div class="text-center text-gray-500 py-6">–£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç –¥—Ä—É–∑–µ–π üò¢</div>';
            }
        }

        function addFriend() {
            const username = document.getElementById('addFriendInput').value.trim();
            if (!username) return;
            if (username === currentUser.username) {
                showNotification('–ù–µ–ª—å–∑—è –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–±—è!', 'error');
                return;
            }
            
            const targetUser = DB.getUser(username);
            if (!targetUser) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                return;
            }
            
            if (currentUser.friends && currentUser.friends.includes(username)) {
                showNotification('–£–∂–µ –≤ –¥—Ä—É–∑—å—è—Ö!', 'error');
                return;
            }
            
            if (!targetUser.friendRequests) targetUser.friendRequests = [];
            if (targetUser.friendRequests.includes(currentUser.username)) {
                showNotification('–ó–∞—è–≤–∫–∞ —É–∂–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!', 'error');
                return;
            }
            
            targetUser.friendRequests.push(currentUser.username);
            DB.saveUser(username, targetUser);
            document.getElementById('addFriendInput').value = '';
            showNotification(`üì® –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ ${username}!`, 'success');
        }

        function acceptFriend(username) {
            if (!currentUser.friends) currentUser.friends = [];
            currentUser.friends.push(username);
            currentUser.friendRequests = currentUser.friendRequests.filter(u => u !== username);
            
            const friend = DB.getUser(username);
            if (friend) {
                if (!friend.friends) friend.friends = [];
                friend.friends.push(currentUser.username);
                DB.saveUser(username, friend);
            }
            
            saveUser();
            updateUI();
            renderFriends();
            showNotification(`üéâ ${username} —Ç–µ–ø–µ—Ä—å —Ç–≤–æ–π –¥—Ä—É–≥!`, 'success');
        }

        function declineFriend(username) {
            currentUser.friendRequests = currentUser.friendRequests.filter(u => u !== username);
            saveUser();
            updateUI();
            renderFriends();
        }

        function removeFriend(username) {
            currentUser.friends = currentUser.friends.filter(u => u !== username);
            const friend = DB.getUser(username);
            if (friend && friend.friends) {
                friend.friends = friend.friends.filter(u => u !== currentUser.username);
                DB.saveUser(username, friend);
            }
            saveUser();
            renderFriends();
            showNotification(`‚ùå ${username} —É–¥–∞–ª—ë–Ω –∏–∑ –¥—Ä—É–∑–µ–π`, 'info');
        }

        // ==================== SEND MONEY ====================
        function openSendMoneyTo(username) {
            sendMoneyTarget = username;
            document.getElementById('sendMoneyTo').textContent = username;
            document.getElementById('sendMoneyAmount').value = '';
            document.getElementById('sendMoneyModal').classList.add('open');
        }
        function closeSendMoney(e) { if (!e || e.target === e.currentTarget) document.getElementById('sendMoneyModal').classList.remove('open'); }

        function confirmSendMoney() {
            const amount = parseFloat(document.getElementById('sendMoneyAmount').value);
            if (!amount || amount <= 0) {
                showNotification('–í–≤–µ–¥–∏ —Å—É–º–º—É!', 'error');
                return;
            }
            if (amount > currentUser.balance) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!', 'error');
                return;
            }
            
            const friend = DB.getUser(sendMoneyTarget);
            if (!friend) {
                showNotification('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                return;
            }
            
            currentUser.balance -= amount;
            friend.balance += amount;
            saveUser();
            DB.saveUser(sendMoneyTarget, friend);
            updateUI();
            closeSendMoney();
            showNotification(`üí∏ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ ${formatMoney(amount)} –¥–ª—è ${sendMoneyTarget}!`, 'success');
        }

        // ==================== SEND ITEMS ====================
        function openSendItems() {
            if (selectedInventoryItems.length === 0) {
                showNotification('–í—ã–±–µ—Ä–∏ –ø—Ä–µ–¥–º–µ—Ç—ã!', 'error');
                return;
            }
            
            const select = document.getElementById('sendItemsTo');
            select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏ –¥—Ä—É–≥–∞...</option>';
            if (currentUser.friends) {
                currentUser.friends.forEach(f => {
                    select.innerHTML += `<option value="${f}">${f}</option>`;
                });
            }
            
            document.getElementById('selectedItemsCount').textContent = selectedInventoryItems.length;
            document.getElementById('sendItemsModal').classList.add('open');
        }
        function closeSendItems(e) { if (!e || e.target === e.currentTarget) document.getElementById('sendItemsModal').classList.remove('open'); }

        function confirmSendItems() {
            const username = document.getElementById('sendItemsTo').value;
            if (!username) {
                showNotification('–í—ã–±–µ—Ä–∏ –¥—Ä—É–≥–∞!', 'error');
                return;
            }
            
            const friend = DB.getUser(username);
            if (!friend) {
                showNotification('–î—Ä—É–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                return;
            }
            
            const itemsToSend = selectedInventoryItems.map(idx => currentUser.inventory[idx]);
            selectedInventoryItems.sort((a, b) => b - a).forEach(idx => currentUser.inventory.splice(idx, 1));
            
            if (!friend.inventory) friend.inventory = [];
            itemsToSend.forEach(item => friend.inventory.push({ ...item, id: Date.now() + Math.random() }));
            
            saveUser();
            DB.saveUser(username, friend);
            selectedInventoryItems = [];
            updateUI();
            renderInventory();
            closeSendItems();
            showNotification(`üì¶ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ ${itemsToSend.length} –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –¥–ª—è ${username}!`, 'success');
        }

        // ==================== EFFECTS ====================
        function createConfetti() {
            const container = document.getElementById('confettiContainer');
            const colors = ['#00f0ff', '#ff00ff', '#00ff88', '#ffd700', '#ff3366'];
            for (let i = 0; i < 100; i++) {
                const c = document.createElement('div');
                c.className = 'confetti-piece';
                c.style.left = Math.random() * 100 + 'vw';
                c.style.top = '-10px';
                c.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                c.style.animationDelay = Math.random() * 2 + 's';
                container.appendChild(c);
            }
            setTimeout(() => container.innerHTML = '', 4000);
        }

        function sendEmoji(emoji) {
            const el = document.createElement('div');
            el.className = 'floating-emoji';
            el.textContent = emoji;
            el.style.left = Math.random() * 80 + 10 + '%';
            el.style.top = '50%';
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 2000);
        }

        function addLiveFeed(username, item, value) {
            const feed = document.getElementById('liveFeedItems');
            const el = document.createElement('div');
            el.className = 'live-feed-item';
            el.innerHTML = `
                <div class="flex items-center justify-between w-full gap-2">
                    <div class="flex items-center gap-2 overflow-hidden">
                        <span class="text-cyan-400 font-bold truncate">${username}</span>
                        <span class="text-gray-400">‚Üí</span>
                        <span class="text-xl">${item.icon}</span>
                        <span class="text-xs text-gray-300 truncate">${item.name.split(' | ')[0]}</span>
                    </div>
                    <span class="text-green-400 font-bold whitespace-nowrap">${formatMoney(value)}</span>
                </div>
            `;
            feed.insertBefore(el, feed.firstChild);
            if (feed.children.length > 10) feed.lastChild.remove();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
            const drops = JSON.parse(localStorage.getItem('cb_live_drops') || '[]');
            drops.unshift({ username, item: { icon: item.icon, name: item.name }, value, time: Date.now() });
            if (drops.length > 20) drops.pop();
            localStorage.setItem('cb_live_drops', JSON.stringify(drops));
        }
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Live Feed –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
        function loadLiveDrops() {
            const drops = JSON.parse(localStorage.getItem('cb_live_drops') || '[]');
            const feed = document.getElementById('liveFeedItems');
            feed.innerHTML = '';
            drops.slice(0, 10).forEach(drop => {
                const el = document.createElement('div');
                el.className = 'live-feed-item';
                el.innerHTML = `
                    <div class="flex items-center justify-between w-full gap-2">
                        <div class="flex items-center gap-2 overflow-hidden">
                            <span class="text-cyan-400 font-bold truncate">${drop.username}</span>
                            <span class="text-gray-400">‚Üí</span>
                            <span class="text-xl">${drop.item.icon}</span>
                            <span class="text-xs text-gray-300 truncate">${drop.item.name.split(' | ')[0]}</span>
                        </div>
                        <span class="text-green-400 font-bold whitespace-nowrap">${formatMoney(drop.value)}</span>
                    </div>
                `;
                feed.appendChild(el);
            });
        }
        
        // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è localStorage –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
        window.addEventListener('storage', (e) => {
            if (e.key === 'cb_live_drops') {
                loadLiveDrops();
            }
            if (e.key === 'cb_global_notification') {
                const data = JSON.parse(e.newValue);
                if (data && data.time > Date.now() - 5000) {
                    displayGlobalNotification(data.text, data.type, data.duration);
                }
            }
            if (e.key === 'cb_active_event') {
                const data = JSON.parse(e.newValue);
                if (data) {
                    syncEvent(data);
                }
            }
        });
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (–≤–∏–¥–Ω—ã –≤—Å–µ–º –Ω–∞ —Å–∞–π—Ç–µ)
        function sendGlobalNotification(text, type = 'info', duration = 5000) {
            const data = { text, type, duration, time: Date.now() };
            localStorage.setItem('cb_global_notification', JSON.stringify(data));
            displayGlobalNotification(text, type, duration);
        }
        
        function displayGlobalNotification(text, type, duration) {
            showNotification(text, type);
            // –ï—Å–ª–∏ —ç—Ç–æ –∏–≤–µ–Ω—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–æ–ª—å—à–µ
            if (duration === 0) return;
        }
        
        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–≤–µ–Ω—Ç–æ–≤ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
        function syncEvent(data) {
            if (data.active) {
                luckMult = data.multiplier || 1;
                document.getElementById('eventBanner').classList.add('show');
                document.getElementById('eventMultiplierText').textContent = data.text || '–ò–í–ï–ù–¢';
            } else {
                luckMult = 1;
                document.getElementById('eventBanner').classList.remove('show');
            }
        }

        // ==================== SETTINGS ====================
        function openSettings() { document.getElementById('settingsPanel').classList.add('open'); document.getElementById('settingsOverlay').classList.add('open'); }
        function closeSettings() { document.getElementById('settingsPanel').classList.remove('open'); document.getElementById('settingsOverlay').classList.remove('open'); }
        function toggleSound() { soundEnabled = !soundEnabled; document.getElementById('soundToggle').classList.toggle('active', soundEnabled); }
        function toggleConfetti() { confettiEnabled = !confettiEnabled; document.getElementById('confettiToggle').classList.toggle('active', confettiEnabled); }
        function updateSpeed() { document.documentElement.style.setProperty('--roulette-speed', document.getElementById('speedSelect').value + 's'); }
        function updateRounds() { totalRounds = parseInt(document.getElementById('roundsSelect').value); document.getElementById('totalRounds').textContent = totalRounds; }

        // ==================== ADMIN ====================
        function adminLogin() {
            if (document.getElementById('adminPass').value === 'admin123') {
                isAdmin = true;
                document.getElementById('adminBtn').classList.add('visible');
                document.getElementById('adminLoginSection').style.display = 'none';
                showNotification('üîß –ê–¥–º–∏–Ω-—Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!', 'success');
            }
        }
        function openAdmin() { if (!isAdmin) return; document.getElementById('adminPanel').classList.add('open'); document.getElementById('adminOverlay').classList.add('open'); }
        function closeAdmin() { document.getElementById('adminPanel').classList.remove('open'); document.getElementById('adminOverlay').classList.remove('open'); }

        function addMoney(amt) { if (!currentUser) return; currentUser.balance += amt; saveUser(); updateUI(); }
        function addRandomItem(rarity) {
            if (!currentUser) return;
            const items = allItems.filter(i => i.rarity === rarity);
            if (items.length) {
                const item = items[Math.floor(Math.random() * items.length)];
                currentUser.inventory.push({ ...item, value: item.baseValue * 2, id: Date.now() });
                saveUser();
                updateUI();
            }
        }
        function godMode() {
            if (!currentUser) return;
            currentUser.balance = 999999999;
            for (let i = 0; i < 20; i++) addRandomItem('godtier');
            saveUser();
            updateUI();
            if (confettiEnabled) createConfetti();
            showNotification('üëë GOD MODE ACTIVATED!', 'success');
        }
        
        function setLuckMult(value) {
            luckMult = parseFloat(value);
            document.getElementById('luckValue').textContent = 'x' + value;
            document.getElementById('luckSlider').value = value;
        }
        
        function clearAllData() {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ!')) {
                localStorage.clear();
                location.reload();
            }
        }
        
        // Dev Tools - –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function sendCustomNotification() {
            const text = document.getElementById('globalNotifText').value.trim();
            const type = document.getElementById('globalNotifType').value;
            if (!text) {
                showNotification('–í–≤–µ–¥–∏ —Ç–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è!', 'error');
                return;
            }
            sendGlobalNotification(text, type);
            document.getElementById('globalNotifText').value = '';
        }
        
        // Dev Tools - –ò–≤–µ–Ω—Ç—ã
        function startEvent(multiplier, text) {
            const duration = parseInt(document.getElementById('eventDuration').value) * 60000;
            const endTime = Date.now() + duration;
            
            const eventData = {
                active: true,
                multiplier: multiplier,
                text: text,
                endTime: endTime
            };
            
            localStorage.setItem('cb_active_event', JSON.stringify(eventData));
            luckMult = multiplier;
            
            document.getElementById('eventBanner').classList.add('show');
            document.getElementById('eventMultiplierText').textContent = text;
            document.getElementById('eventStatus').textContent = text;
            document.getElementById('eventStatus').className = 'text-green-400 text-sm font-bold';
            
            updateEventTimer(endTime);
            
            sendGlobalNotification(`üéä ${text} –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–∞ ${document.getElementById('eventDuration').value} –º–∏–Ω!`, 'success');
            if (confettiEnabled) createConfetti();
        }
        
        function stopEvent() {
            localStorage.setItem('cb_active_event', JSON.stringify({ active: false }));
            luckMult = 1;
            document.getElementById('eventBanner').classList.remove('show');
            document.getElementById('eventStatus').textContent = '–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–≤–µ–Ω—Ç–∞';
            document.getElementById('eventStatus').className = 'text-gray-500 text-sm';
            sendGlobalNotification('üèÅ –ò–≤–µ–Ω—Ç –∑–∞–≤–µ—Ä—à—ë–Ω!', 'info');
        }

        // ==================== TABS ====================
        function switchMainTab(tab) {
            ['cases', 'battle', 'modes', 'tournaments'].forEach(t => {
                document.getElementById(`tab${t.charAt(0).toUpperCase() + t.slice(1)}`).classList.toggle('active', t === tab);
                document.getElementById(`${t}Section`).classList.toggle('hidden', t !== tab);
            });
            if (tab === 'cases') initRoulette();
            if (tab === 'battle') { initBattleRoulettes(); resetBattle(); }
        }

        function openProfile() { showNotification('–ü—Ä–æ—Ñ–∏–ª—å: ' + currentUser.username, 'info'); }

        // ==================== FAKE ONLINE ====================
        setInterval(() => {
            const current = parseInt(document.getElementById('onlineCount').textContent.replace(/,/g, ''));
            const change = Math.floor(Math.random() * 20) - 10;
            document.getElementById('onlineCount').textContent = Math.max(500, current + change).toLocaleString();
        }, 5000);

        // ==================== INIT ====================
        document.addEventListener('DOMContentLoaded', () => {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º live drops —Å—Ä–∞–∑—É
            loadLiveDrops();
            
            const savedUser = DB.getCurrentUser();
            if (savedUser) {
                const users = DB.getUsers();
                // –ò—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                let foundUser = null;
                for (const key of Object.keys(users)) {
                    if (key.toLowerCase() === savedUser.toLowerCase()) {
                        foundUser = users[key];
                        break;
                    }
                }
                
                if (foundUser) {
                    currentUser = foundUser;
                    currentUser.lastOnline = Date.now();
                    DB.saveUser(currentUser.username, currentUser);
                    showGame();
                }
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∏–≤–µ–Ω—Ç—ã
            const activeEvent = JSON.parse(localStorage.getItem('cb_active_event') || 'null');
            if (activeEvent && activeEvent.active && activeEvent.endTime > Date.now()) {
                syncEvent(activeEvent);
                updateEventTimer(activeEvent.endTime);
            }
        });
        
        function updateEventTimer(endTime) {
            const interval = setInterval(() => {
                const remaining = endTime - Date.now();
                if (remaining <= 0) {
                    clearInterval(interval);
                    localStorage.setItem('cb_active_event', JSON.stringify({ active: false }));
                    document.getElementById('eventBanner').classList.remove('show');
                    luckMult = 1;
                    return;
                }
                const mins = Math.floor(remaining / 60000);
                const secs = Math.floor((remaining % 60000) / 1000);
                document.getElementById('eventTimer').textContent = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            }, 1000);
        }
    </script>
</body>
</html>
